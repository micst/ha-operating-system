var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}return globalThis};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");var xnm=xnm||{};xnm.aio=xnm.aio||{};xnm.aio.hautau=xnm.aio.hautau||{};
xnm.aio.hautau.Gateway=function(){var a=function(b,c){this._logger="undefined"==typeof require||null==require?{log:function(){}}:require("x.logger.js").getLogger("xnm.aio.hautau.Gateway");this.ip=b;this.port=c;this.port||(this.port=80);this.timeout=1E3;this._statesBuffer={};this._fifo=[]};a.DEVICETYPE_MAP={0:"general",1:"multisensor",2:"outputbox203v",4:"general",5:"ventra",6:"general",7:"general",8:"general",9:"drive",10:"general",11:"general",100:"general",101:"ska20cd",102:"drive",103:"hscd",104:"general",
105:"ventra2",106:"drive",107:"general",108:"general",255:"general"};a.prototype.executeCommandCreator=function(b,c,d){if(c&&c.value)if(b)if("undefined"==typeof b.address||null==b.address)d&&d(Error("device json format invali"));else switch(c.value){case "open":this._open(b.address,d);break;case "close":this._close(b.address,d);break;case "stop":this._stop(b.address,d);break;case "levelUp":this._setVentraLevel(b.address,"up",d);break;case "levelDown":this._setVentraLevel(b.address,"down",d);break;
case "levelTo":this._setVentraLevel(b.address,c.ext,d);break;case "keyboardOn":this._setVentraKeyboard(b.address,"on",d);break;case "keyboardOff":this._setVentraKeyboard(b.address,"off",d);break;case "lockOn":this._setHscdLock(b.address,"on",d);break;case "lockOff":this._setHscdLock(b.address,"off",d);break;default:d&&d(Error("command not exist"))}else d&&d(Error("device json is null"));else d&&d(Error("command json format invalid"))};a.prototype.getStatesCreator=function(b,c,d){for(var e={},a=0;a<
c.length;a++)(b=c[a])&&b.device&&"undefined"!=typeof b.device.address&&null!=b.device.address&&b.device.type&&(e[b.device.address]=b.device.type);var g=[],l=this,h=Object.keys(e);a=0;var m=function(b,f){if(!b&&f){b=h[a];if(f){for(var r=[],p=0;p<c.length;p++){var n=c[p];if(n&&n.id&&n.device&&n.device.address&&n.device.address==b&&n.status&&n.status.value){var k=f[n.status.value];"undefined"!=typeof k&&null!=k&&r.push({id:n.id,status:k})}}f=r}else f=[];f&&(g=g.concat(f))}a++;a<h.length?l._getDeviceStates(h[a],
e[h[a]],m):d&&d(null,g)};this._getDeviceStates(h[a],e[h[a]],m)};a.prototype.listDevices=function(b,c){var d=this,e=!1,a=0,g=30;if("object"===typeof b&&null!==b){var l=Number(b.start),h=Number(b.end),m=b.custom||null;m&&0<m.length&&(e=!0);e?a=m[0]:(!isNaN(l)&&0<=l&&255>=l&&(a=l),!isNaN(h)&&0<=h&&255>=h&&(g=h),g<a&&(g=a))}var k=a,q=0,r=[],p=function(b,f){b&&-3!=b.code?a==k&&5>q?(q++,d._ping(a,p)):c&&c(b,r):(!b&&f&&(f.sys="hautau",f.type=f.DeviceType,f.address=a,r.push(f)),e?(m.shift(),a=m[0],0==m.length?
c&&c(null,r):d._ping(a,p)):(a++,a>g?c&&c(null,r):d._ping(a,p)))};this._ping(a,p)};a.prototype._getDeviceStates=function(b,c,d){var e=(new Date).getTime(),f=!1,g=this._statesBuffer[b];g?g.timestamp&&3E3<e-g.timestamp&&(f=!0,g.timestamp=e):(f=!0,this._statesBuffer[b]={states:null,timestamp:e},g=this._statesBuffer[b]);c=a.DEVICETYPE_MAP[c];if("undefined"==typeof c||null==c)d&&d(Error("unknown device type"));else if(f){var l=this;this.getDeviceStates(b,c,function(c,a){!c&&a&&(l._statesBuffer[b]={states:a,
timestamp:(new Date).getTime()});d&&d(c,a)})}else d&&d(null,g.states)};a.prototype.getDeviceStates=function(b,c,a){switch(c){case "drive":this._getDriveStates(b,function(b,c){a&&a(b,c)});break;case "multisensor":this._getMultiSensorStates(b,function(b,c){a&&a(b,c)});break;case "ska20cd":this._getSka20cdStates(b,function(b,c){a&&a(b,c)});break;case "ventra":case "ventra2":this._getVentraStates(b,function(b,c){a&&a(b,c)});break;case "hscd":case "hscdi":this._getHscdStates(b,function(b,c){a&&a(b,c)});
break;default:a&&a(null,null)}};a.prototype._open=function(b,c){this._executeRequest("/hautau/open",{adr:b},null,function(b,a){c&&c(b,a)})};a.prototype._close=function(b,c){this._executeRequest("/hautau/close",{adr:b},null,function(b,a){c&&c(b,a)})};a.prototype._stop=function(b,c){this._executeRequest("/hautau/stop",{adr:b},null,function(b,a){c&&c(b,a)})};a.prototype._getDriveStates=function(b,c){this._executeRequest("/hautau/drive",{adr:b,state:"show"},null,function(b,a){b?c&&c(b,a):(b={Closed:"yes"==
a.Closed,Opened:"yes"==a.Opened,PowerCutoff:"yes"==a.PowerCutoff,State:"yes"==a.Closed?"closed":"open"},c&&c(null,b))})};a.prototype._getMultiSensorStates=function(b,c){this._executeRequest("/hautau/multisensor",{adr:b,state:"show"},null,function(b,a){b?c&&c(b,a):(a.Temperature=a.Temperature.toFixed(1),c&&c(null,a))})};a.prototype._getSka20cdStates=function(b,c){this._executeRequest("/hautau/ska20cd",{adr:b,state:"show"},null,function(b,a){b?c&&c(b,a):(b={Closed:"yes"==a.Closed,Opened:"yes"==a.Opened,
PowerCutoff:"yes"==a.PowerCutoff,State:"yes"==a.Closed?"closed":"open"},c&&c(null,b))})};a.prototype._getVentraStates=function(b,a){this._executeRequest("/hautau/ventra",{adr:b,state:"show"},null,function(b,c){b?a&&a(b,c):(c.FilterChange="yes"==c.FilterChange,a&&a(null,c))})};a.prototype._setVentraLevel=function(b,a,d){var c=this;a||(a=0);this._executeRequest("/hautau/ventra",{adr:b,level:a},null,function(a,e){if(a)d&&d(a,e);else{if("undefined"!=typeof e.Level&&null!=e.Level){a=(new Date).getTime();
var f=c._statesBuffer[b];f||(c._statesBuffer[b]={states:{},timestamp:a},f=c._statesBuffer[b]);f.states.Level=e.Level}d&&d(null,e)}})};a.prototype._setVentraKeyboard=function(b,a,d){var c=this;this._executeRequest("/hautau/ventra",{adr:b,keyboard:a},null,function(a,e){if(a)d&&d(a,e);else{if("undefined"!=typeof e.Keyboard&&null!=e.Keyboard){a=(new Date).getTime();var f=c._statesBuffer[b];f||(c._statesBuffer[b]={states:{},timestamp:a},f=c._statesBuffer[b]);f.states.Keyboard=e.Keyboard}d&&d(null,e)}})};
a.prototype._getHscdStates=function(b,a){this._executeRequest("/hautau/hscd",{adr:b,state:"show"},null,function(b,c){b?a&&a(b,c):(c.WindowDown="yes"==c.WindowDown,c.WindowClosed="yes"==c.WindowClosed,c.State=c.WindowClosed?"closed":"open",a&&a(null,c))})};a.prototype._setHscdLock=function(b,a,d){var c=this;this._executeRequest("/hautau/hscd",{adr:b,lock:a},null,function(a,e){if(a)d&&d(a,e);else if("undefined"!=typeof e.Lock&&null!=e.Lock){a=(new Date).getTime();var f=c._statesBuffer[b];f||(c._statesBuffer[b]=
{states:{},timestamp:a},f=c._statesBuffer[b]);f.states.Lock=e.Lock;d&&d(null,e)}})};a.prototype._ping=function(a,c){this._executeRequest("/hautau/ping",{adr:a},2E3,c)};a.prototype._executeRequest=function(a,c,d,e){var b=this._fifo.length;this._fifo.push({path:a,params:c,timeout:d,callback:e});0==b&&this._doNextRequest()};a.prototype._doNextRequest=function(){if(0!=this._fifo.length){var a=this._fifo[0],c=this;this._doJsonRequest(a.path,a.params,a.timeout,function(b,e){try{a.callback&&a.callback(b,
e)}catch(f){}c._fifo.splice(0,1);c._doNextRequest()})}};a.prototype._doJsonRequest=function(a,c,d,e){this._doRequest("GET",a,c,d,function(a,b){if(a)e&&e(a);else if(b)try{var c=JSON.parse(b);"ok"!=c.Result?(a=Error(c.Result?c.Result:"result param is empty"),a.code=-3,e&&e(a)):e&&e(null,c)}catch(h){h.code=-2,e&&e(h)}else a=Error("request empty"),a.code=-2,e&&e(a)})};a.prototype._doRequest2=function(a,c,d,e,f){e||(e=this.timeout);var b=this;c="http://"+this.ip+":"+this.port+c;if(d){var l=[],h;for(h in d){var m=
d[h];if("undefined"==typeof m||null==m)m="";l.push(h+"="+encodeURIComponent(m))}c+="?"+l.join("&")}this._logger.log("trace","send "+a+" to url:"+c);var k=f;$.ajax({url:c,type:a,timeout:e,dataType:"text",cache:!0,success:function(a){b._logger.log("trace","http request success:"+a);k&&(k(null,a),k=null)},error:function(a,c){a="http request error:"+(a?a.status:"0")+"-"+c;b._logger.log("trace",a);k&&(a=Error(a),a.code=-1,k(a),k=null)}})};a.prototype._doRequest=function(a,c,d,e,f){e||(e=this.timeout);
var b=this;if(d){var l=[],h;for(h in d){var m=d[h];if("undefined"==typeof m||null==m)m="";l.push(h+"="+encodeURIComponent(m))}c+="?"+l.join("&")}this._logger.log("trace","send "+a+" to url: http://"+this.ip+":"+this.port+c);a={host:this.ip,port:this.port,path:c,method:a,headers:{"Content-Type":'application/json; charset="UTF-8"',"User-Agent":"mediola",Connection:"close"},timeout:e};var k=f,q=require("http").request(a,function(a){a.setEncoding("utf-8");var c="";a.on("data",function(a){c+=a});a.on("end",
function(){b._logger.log("trace","http response "+a.statusCode+": "+c);if(200==a.statusCode)k&&k(null,c);else{var d=Error("http response "+a.statusCode);d.code=-1;k&&k(d)}k=null})});q.on("timeout",function(){b._logger.log("trace","http request timeout");if(k){var a=Error("http request timeout");a.code=-1;k(a);k=null}q.abort()});q.on("error",function(a){b._logger.log("trace","http request error:"+a.message);k&&(k(a),k=null)});q.end()};a.prototype.toJSON=function(){return{sys:"hautau",ip:this.ip,port:this.port}};
a.prototype.equalsTo=function(b){return b&&b instanceof a?this.ip==b.ip&&this.port==b.port:!1};a.parseJSON=function(b){return b.ip?new a(b.ip,b.port):null};return a}();
xnm.aio.hautau.DM=function(){var a=function(a,b){this.code=a;this.message=b;this.stack=Error().stack};a.prototype=Error();a.prototype.name="HautauDMError";a.prototype.code=0;a.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6};var b={general:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"stop",ref:{value:"stop"}}]},outputbox203v:{command:[{type:"enum",name:"open",ref:{value:"open"}},
{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"stop",ref:{value:"stop"}}]},multisensor:{status:[{type:"int",name:"co2",ref:{value:"CO2"}},{type:"float",name:"temperature",ref:{value:"Temperature"}},{type:"int",name:"humidity",ref:{value:"Humidity"}}]},drive:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"stop",ref:{value:"stop"}}],status:[{type:"enum",name:"power cutoff",ref:{value:"PowerCutoff",options:["true",
"false"]}},{type:"enum",name:"opened",ref:{value:"Opened",options:["true","false"]}},{type:"enum",name:"closed",ref:{value:"Closed",options:["true","false"]}},{type:"enum",name:"state",ref:{value:"State",options:["open","closed"]}}]},ska20cd:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"stop",ref:{value:"stop"}}],status:[{type:"enum",name:"power cutoff",ref:{value:"PowerCutoff",options:["true","false"]}},{type:"enum",name:"opened",
ref:{value:"Opened",options:["true","false"]}},{type:"enum",name:"closed",ref:{value:"Closed",options:["true","false"]}},{type:"enum",name:"state",ref:{value:"State",options:["open","closed"]}}]},ventra:{command:[{type:"int",name:"set level",ref:{value:"levelTo",ext:"%d",extMeta:"0-3"}},{type:"enum",name:"level up",ref:{value:"levelUp"}},{type:"enum",name:"level down",ref:{value:"levelDown"}}],status:[{type:"enum",name:"error",ref:{value:"Errors",options:"no temperature fan1 fan2 keyboard opened".split(" ")}},
{type:"enum",name:"change filter",ref:{value:"FilterChange",options:["true","false"]}},{type:"int",name:"filter percent",ref:{value:"FilterPercent",extMeta:"0-100"}},{type:"int",name:"level0 runtime",ref:{value:"RuntimeLevel0"}},{type:"int",name:"level1 runtime",ref:{value:"RuntimeLevel1"}},{type:"int",name:"level2 runtime",ref:{value:"RuntimeLevel2"}},{type:"int",name:"level3 runtime",ref:{value:"RuntimeLevel3"}},{type:"int",name:"level",ref:{value:"Level",extMeta:"0-4"}},{type:"enum",name:"keyboard",
ref:{value:"Keyboard",options:["on","off"]}}]},ventra2:{command:[{type:"int",name:"set level",ref:{value:"levelTo",ext:"%d",extMeta:"0-5"}},{type:"enum",name:"level up",ref:{value:"levelUp"}},{type:"enum",name:"level down",ref:{value:"levelDown"}}],status:[{type:"enum",name:"error",ref:{value:"Errors",options:"no temperature fan1 fan2 keyboard opened humidity".split(" ")}},{type:"enum",name:"change filter",ref:{value:"FilterChange",options:["true","false"]}},{type:"int",name:"filter percent",ref:{value:"FilterPercent",
extMeta:"0-100"}},{type:"int",name:"level0 runtime",ref:{value:"RuntimeLevel0"}},{type:"int",name:"level1 runtime",ref:{value:"RuntimeLevel1"}},{type:"int",name:"level2 runtime",ref:{value:"RuntimeLevel2"}},{type:"int",name:"level3 runtime",ref:{value:"RuntimeLevel3"}},{type:"int",name:"level",ref:{value:"Level",extMeta:"0-5"}},{type:"enum",name:"keyboard",ref:{value:"Keyboard",options:["on","off"]}},{type:"float",name:"temperature",ref:{value:"Temperature"}},{type:"int",name:"humidity",ref:{value:"Humidity"}}]},
hscd:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"stop",ref:{value:"stop"}}],status:[{type:"enum",name:"error",ref:{value:"Errors",options:"no safety current keyboard sw cpu checksum ram watchdog stop safetystop pos speed vars phase".split(" ")}},{type:"enum",name:"window down",ref:{value:"WindowDown",options:["true","false"]}},{type:"enum",name:"window closed",ref:{value:"WindowClosed",options:["true","false"]}},{type:"enum",
name:"window state",ref:{value:"State",options:["open","closed"]}}]},hscdi:{command:[{type:"enum",name:"open",ref:{value:"open"}},{type:"enum",name:"close",ref:{value:"close"}},{type:"enum",name:"stop",ref:{value:"stop"}},{type:"enum",name:"hscd_lockOn",ref:{value:"lockOn"}},{type:"enum",name:"hscd_lockOff",ref:{value:"lockOff"}}],status:[{type:"enum",name:"error",ref:{value:"Errors",options:"no safety current keyboard sw cpu checksum ram watchdog stop safetystop pos speed vars phase".split(" ")}},
{type:"enum",name:"lock",ref:{value:"Lock",options:["on","off"]}},{type:"enum",name:"window down",ref:{value:"WindowDown",options:["true","false"]}},{type:"enum",name:"window closed",ref:{value:"WindowClosed",options:["true","false"]}},{type:"enum",name:"window state",ref:{value:"State",options:["open","closed"]}},{type:"enum",name:"position percent (internorm)",ref:{value:"Position",extMeta:"0-100"}},{type:"enum",name:"number of driving cycles (internorm)",ref:{value:"Cycles",extMeta:"0-10000"}}]}};
return{SYS:"hautau",getGatewayType:function(){return[{sys:this.SYS,name:"HAUTAU WLAN-Box",port:80}]},getGatewayDeviceType:function(){return[{sys:this.SYS,type:0,name:"Rauchmeldezentrale (RAZK)"},{sys:this.SYS,type:1,name:"Multisensor MS"},{sys:this.SYS,type:2,name:"Output Box 230V"},{sys:this.SYS,type:4,name:"LSF"},{sys:this.SYS,type:5,name:"Fensterl\u00fcfter Ventra 301"},{sys:this.SYS,type:6,name:"Primat kompakt"},{sys:this.SYS,type:7,name:"Small Master"},{sys:this.SYS,type:8,name:"Fensterl\u00fcfter Monitor"},
{sys:this.SYS,type:9,name:"Primat kompakt 195"},{sys:this.SYS,type:10,name:"RWA Taster"},{sys:this.SYS,type:11,name:"Rauchmelder"},{sys:this.SYS,type:100,name:"Wlan Box"},{sys:this.SYS,type:101,name:"SKA 20 comfort drive"},{sys:this.SYS,type:102,name:"SM2/EM2 comfort drive"},{sys:this.SYS,type:103,name:"Atrium HS comfort drive"},{sys:this.SYS,type:104,name:"Lamelle"},{sys:this.SYS,type:105,name:"Fensterl\u00fcfter Ventra 302"},{sys:this.SYS,type:106,name:"Neu Primat kompakt 195"},{sys:this.SYS,type:107,
name:"SBS comfort drive"},{sys:this.SYS,type:108,name:"Primat kompakt SOBINCO"}]},createGateway:function(b,d,e){d=a.ERROR_CODE;b?b.ip?e(null,b):e(new a(d.INVALID,"ip is invalid")):e(new a(d.INVALID,"info is invalid"))},updateGateway:function(b,d,e,f){b=a.ERROR_CODE;d?d.ip?f(null,d):f(new a(b.INVALID,"ip is invalid")):f(new a(b.INVALID,"update is invalid"))},deleteGateway:function(a,b,e){e()},createDevice:function(b,d,e){var c=a.ERROR_CODE;if(b)if(b.gateway)if(null==b.address||"undefined"==typeof b.address)e(new a(c.INVALID,
"address is invalid"));else if(null==b.type||"undefined"==typeof b.type)e(new a(c.INVALID,"type is invalid"));else{d=d.data.gateways;var g;for(g=0;g<d.length;g++)if(d[g].index===b.gateway){var l=d[g];break}l?e(null,b):e(new a(c.NOT_FOUND,"gateway with index "+b.gateway+" not exists"))}else e(new a(c.INVALID,"gateway is invalid"));else e(new a(c.INVALID,"info is invalid"))},updateDevice:function(b,d,e){var c=a.ERROR_CODE;if(b)if(b.gateway)if(null==b.address||"undefined"==typeof b.address)e(new a(c.INVALID,
"address is invalid"));else if(null==b.type||"undefined"==typeof b.type)e(new a(c.INVALID,"type is invalid"));else{d=d.data.gateways;var g;for(g=0;g<d.length;g++)if(d[g].index===b.gateway){var l=d[g];break}l?e(null,b):e(new a(c.NOT_FOUND,"gateway with index "+b.gateway+" not exists"))}else e(new a(c.INVALID,"gateway is invalid"));else e(new a(c.INVALID,"info is invalid"))},deleteDevice:function(a,b,e){e()},applyUIFilter:function(a,b){var c=this,d=function(a,b,c){var e=[];a.forEach(function(a){if("root"==
a.type){a=JSON.parse(JSON.stringify(a));var f=d(a.children,b,c);f&&0<f.length&&(a.children=f,e.push(a))}else{f=c.elems;if("*"==f)f=!0;else{for(var g=!1,h=0;h<f.length;h++)if(f[h]==a.type){g=!0;break}f=g}f&&(a=JSON.parse(JSON.stringify(a)),e.push(a))}});return e},g=function(a,b){var e=[],f=c.getCommandStatusMap(a);if(f){var g=[];switch(b.catagory){case "command":f.command&&(g=d(f.command,a,b));break;case "status":f.status&&(g=d(f.status,a,b))}e=e.concat(g)}return e};if(!a.sys)return null;var l=JSON.parse(JSON.stringify(a)),
h=null;switch(b.catagory){case "command":h=g(a,b);l.command=h;break;case "status":h=g(a,b);l.status=h;break;default:return null}return h&&0!=h.length?l:null},getCommandStatusMap:function(a){return a&&"undefined"!=typeof a.type&&null!=a.type?b[a.type]?b[a.type]:(a=xnm.aio.hautau.Gateway.DEVICETYPE_MAP[a.type])?b[a]:null:null}}}();xnm.aio.hautau.RulesManager=function(){};
xnm.aio.hautau.RulesManager.prototype.getDeviceChannels=function(a,b,c){a=[];"drive"!=b&&"ska20cd"!=b&&"hscd"!=b&&"hscdi"!=b||"action"!=c||(a=["state"]);return a};xnm.aio.hautau.RulesManager.prototype.getCommands=function(a,b,c,d){a=[];if(("drive"==b||"ska20cd"==b||"hscd"==b||"hscdi"==b)&&"action"==c)for(b=xnm.aio.hautau.DM.getCommandStatusMap({type:b}).command,c=0;c<b.length;c++)a.push({action:"",id:window.XC_Text[b[c].name],subtype:"command",sys:"hautau",type:"action",value:b[c].ref.value});return a};
xnm.aio.hautau.Handler=function(){var a=function(){};a.prototype.Gateway=xnm.aio.hautau.Gateway;a.prototype.devicemanager=xnm.aio.hautau.DM;a.prototype.RulesManager=xnm.aio.hautau.RulesManager;a.prototype.registModule=function(a){a.register(this.devicemanager.SYS,"hautau")};a.prototype.resolveGateway=function(a){return a?this.Gateway.parseJSON(a):null};a.prototype.getDeviceCommands=function(a,c){a=(a=this.devicemanager.applyUIFilter(a,{catagory:"command",elems:"*"}))?a.command:[];c&&c(null,a)};a.prototype.getDeviceStatus=
function(a,c){a=(a=this.devicemanager.applyUIFilter(a,{catagory:"status",elems:"*"}))?a.status:[];c&&c(null,a)};a.prototype.doCommand=function(a,c,d,e){(a=this.resolveGateway(a))?a.executeCommandCreator(c,d,function(a){e&&e(a)}):e&&e(Error("gateway json format invalid"))};a.prototype.doStatus=function(a,c,d,e,f){(c=this.resolveGateway(c))?c.getStatesCreator(null,[{id:a,device:d,status:e}],function(a,b){a?f&&f(a):f&&f(null,b[0])}):f&&f(Error("device json format invalid"))};a.prototype.getDeviceList=
function(a,c,d){(a=this.resolveGateway(a))?a.listDevices(c,function(a,b){d&&d(a,b)}):d&&d(Error("gateway json format invalid"))};a.prototype.getDeviceCommandList=function(a){};a.prototype.discoverWithTimeout=function(a,c){var b={};require("x.upnp.js").discoverDevicesWithTimeout(a,function(a){if(a.deviceType&&-1!=a.deviceType.indexOf("urn:hautau-de:device:WLAN-Box")){var c=new xnm.aio.hautau.Gateway(a.ip);b[a.ip]||(b[a.ip]=c)}});setTimeout(function(){var a=[],d;for(d in b)a.push(b[d]);c&&c(null,a)},
a)};return a}();"undefined"!=typeof module&&null!=module&&(module.exports=new xnm.aio.hautau.Handler);
