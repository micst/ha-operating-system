var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}return globalThis};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in c||(c[f]={});c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");var xnm=xnm||{};xnm.aio=xnm.aio||{};xnm.aio.symcon=xnm.aio.symcon||{};xnm.aio.symcon.TYPE_BOOL=0;
xnm.aio.symcon.TYPE_INT=1;xnm.aio.symcon.TYPE_FLOAT=2;xnm.aio.symcon.TYPE_STRING=3;xnm.aio.symcon.Util={clearHttpOptionForLog:function(a){try{var b=JSON.parse(JSON.stringify(a));b.auth&&(b.auth="xxxxxx:xxxxxx");if(b.headers)for(var c in headers)if(c&&"authorization"==c.toLocaleLowerCase()){var d=headers[c];if(d){var f=d.indexOf(" ");headers[c]=-1==f?"xxxxxx":d.substr(0,f)+" xxxxxx"}}return b}catch(e){return a}}};
xnm.aio.symcon.Server=function(a,b,c,d,f,e,g){try{this._logger=require("x.logger.js").getLogger("xnm.aio.symcon.Server")}catch(h){this._logger={log:function(){}}}this.ip=a;this.port=b?b:82;this.user=c;this.password=d;this.webusr="webfront";this.webid=f;this.webpwd=e;this.ver=g;this._id=1;this.scripts={};this.instances={};this.variables={};this._scanning=!1;this._scanCallbacks=[];this._scanListener=[];this.CommandHandler=null};
xnm.aio.symcon.Server.prototype._doRequest=function(a,b,c){b='{"jsonrpc": "2.0", "params": '+JSON.stringify(b)+', "method": "'+a+'", "id": '+this._id++ +"}";"WFC_"==a.substr(0,4)?(this._logger.log("trace","do WFC_ request with cred:xxxxxx pwd:xxxxxx"),a=this.webpwd?"Basic "+(new Buffer(this.webusr+":"+this.webpwd)).toString("base64"):null):(this._logger.log("trace","do request with cred:xxxxxx pwd:xxxxxx"),a=this.user||this.password?"Basic "+(new Buffer(this.user+":"+this.password)).toString("base64"):
null);var d={host:this.ip,port:this.port,path:"/api/",method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8","Content-Length":b.length,"User-Agent":"mediola",Connection:"close"}};a&&(d.headers.Authorization=a);this._logger.log("trace","do request:"+JSON.stringify(xnm.aio.symcon.Util.clearHttpOptionForLog(d)));this._logger.log("trace","with data:"+b);var f=this,e=require("http").request(d,function(a){a.setEncoding("utf-8");var b="";a.on("data",function(a){b+=a});a.on("end",function(){f._logger.log("trace",
"do request reponse:"+a.statusCode);f._logger.log("trace",b);if(200==a.statusCode){var d={};try{var e=JSON.parse(b);e&&e.error?(d.error="unknown",e.error.message&&(d.error=e.error.message),e.error.code&&(d.errorCode=e.error.code)):d.data=e.result}catch(m){}c&&c(d)}else c&&c(null)})});e.setTimeout(5E3,function(){f._logger.log("trace","do request timeout");e.abort()});e.on("error",function(a){f._logger.log("trace","do request error:"+a.message);f._logger.log("trace",a.stack);c&&c({error:a&&a.message?
a.message:"http requeset error"})});b&&e.write(b);e.end()};
xnm.aio.symcon.Server.prototype._scanInstanceFunctions=function(a,b){var c=this;this._doRequest("IPS_GetFunctionList",[a],function(a){if(a)if(a.error)b(Error(a.error));else{var d=[];if(a.data)for(var e=a.data.length,g=0;g<a.data.length;g++){var h=a.data[g];"IPS_"==h.substr(0,4)?(e--,0==e&&b(null,d)):functions[h]?(e--,d.push(functions[h])):c._scanFunction(a.data[g],function(a,c){e--;!a&&c&&(functions[c.FunctionName]=c,d.push(c));0==e&&b(null,d)})}else b(null,d)}else b(Error("http error"))})};
xnm.aio.symcon.Server.prototype._scanFunction=function(a,b){this._doRequest("IPS_GetFunction",[a],function(a){if(a)if(a.error)b(Error(a.error));else{var c=null;a&&a.data&&(c=a.data);b(null,c)}else b(Error("http error"))})};xnm.aio.symcon.Server.prototype._scanWebfront=function(a){this._doRequest("WFC_GetConfigurators",[],function(b){if(b)if(b.error)a(Error(b.error));else{var c=[];b&&b.data&&0<b.data.length&&b.data.forEach(function(a){a.id&&c.push({id:a.id,requirepwd:a.password})});a(null,c)}else a(Error("http error"))})};
xnm.aio.symcon.Server.prototype.scanObjects=function(a,b){var c=function(a,b){if(!a||!b)return null;for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1},d=function(a,b,c){a._scanListener.forEach(function(a){a.finish&&"function"==typeof a.finish&&a.finish(b,c)});a._scanCallbacks.forEach(function(a){a&&a(b,c)});a._scanning=!1;a._scanCallbacks=[];a._scanListener=[]},f=function(a,b,c){a._doRequest("IPS_GetVariable",[b],function(a){if(a)if(a.error)c(Error(a.error));else{var d=null;if(a&&a.data)if(d=
{},d.id=b,null!=a.data.VariableType&&"undefined"!=typeof a.data.VariableType)d.valuetype=parseInt(a.data.VariableType),d.value=a.data.VariableValue;else if(null!=a.data.VariableValue&&"undefined"!=typeof a.data.VariableValue&&(a=a.data.VariableValue,null!=a.ValueType&&"undefined"!=typeof a.ValueType))switch(d.valuetype=a.ValueType,parseInt(d.valuetype)){case 0:d.value=a.ValueBoolean;break;case 1:d.value=a.ValueInteger;break;case 2:d.value=a.ValueFloat;break;case 3:d.value=a.ValueString}c(null,d)}else c(Error("http error"))})},
e=function(a,b,c){g(a,b,{instances:{},variables:{},scripts:{}},function(b,d){if(b)c(b);else{var e;b={};var f={};for(e in d.variables)if(d.variables.hasOwnProperty(e))if(d.variables[e].parentid){var g=d.instances[d.variables[e].parentid];g?(g.variables||(g.variables=[]),g.variables.push(d.variables[e])):f[e]=d.variables[e]}else f[e]=d.variables[e];b.instances={};for(e in d.instances)d.instances.hasOwnProperty(e)&&d.instances[e]&&d.instances[e].variables&&0<d.instances[e].variables.length&&(b.instances[e]=
d.instances[e]);b.scripts=d.scripts;b.variables=f;a.instances=b.instances;a.scripts=b.scripts;a.variables=b.variables;c(null,b)}})},g=function(a,b,c,d){if(0==b.length)d(null,c);else{var e=b.pop();a._doRequest("IPS_GetObject",[e],function(e){if(e)if(e.error)d(e.error);else if(a._scanListener.forEach(function(a){if(a.one&&"function"==typeof a.one)a.one()}),e.data){var h=e.data.ObjectID;switch(e.data.ObjectType){case 1:var k=e.data.ChildrenIDs;k&&0<k.length&&!c.instances[h]&&(c.instances[h]={name:e.data.ObjectName,
type:1,objectid:h});g(a,b,c,d);break;case 2:c.variables[h]?g(a,b,c,d):(c.variables[h]={name:e.data.ObjectName,parentid:e.data.ParentID,type:2,objectid:h},f(a,h,function(e,f){e?d(e):(f&&(c.variables[h].valuetype=f.valuetype,c.variables[h].value=f.value),g(a,b,c,d))}));break;case 3:c.scripts[h]||(c.scripts[h]={name:e.data.ObjectName,parentid:e.data.ParentID,hidden:e.data.ObjectIsHidden,type:3,objectid:h});g(a,b,c,d);break;default:g(a,b,c,d)}}else g(a,b,c,d);else d(Error("http error"))})}};b&&!c(this._scanCallbacks,
b)&&this._scanCallbacks.push(b);a&&!c(this._scanListener,a)&&this._scanListener.push(a);if(!this._scanning){this.scripts={};this.instances={};var h=this;this._scanListener.forEach(function(a){a.start&&"function"==typeof a.start&&a.start()});this._doRequest("IPS_GetObjectList",[],function(a){var b;a?a.error&&(b=Error(a.error)):b=Error("http request error");b?d(h,b):a.data&&0!=a.data.length?(h._scanListener.forEach(function(b){b.total&&"function"==typeof b.total&&b.total(a.data.length)}),e(h,a.data,
function(a,b){d(h,a,b)})):d(h,b,{instance:{},scripts:{}})})}};xnm.aio.symcon.Server.prototype.getState=function(a,b,c){c&&this._doRequest(b?"GetValueFormatted":"GetValue",[a.id],function(a){a?a.error?c&&c(Error(a.error)):c&&c(null,a.data):(a=Error("http request error"),a._code=1,c&&c(a))})};xnm.aio.symcon.Server.prototype.executeCommand=function(a,b,c){var d=!1;"on"==b&&(d=!0);this._doRequest("SetValue",[a.id,d],function(a){c&&c()})};xnm.aio.symcon.Server.prototype.getStates=function(a,b,c){};
xnm.aio.symcon.Server.prototype.getStateValues=function(a,b){return sv};xnm.aio.symcon.Server.prototype._getVariableFromInstance=function(a,b){if(!b.variables)return null;for(var c=0;c<b.variables.length;c++)if(b.variables[c].objectid==a)return b.variables[c];return null};
xnm.aio.symcon.Server.prototype.executeCommandCreator=function(a,b,c){if(a&&a.objectid&&b&&b.value){var d=b.value,f=a.objectid,e=d.indexOf("#");0<e&&(f=d.substr(0,e),d=d.substr(e+1));e=a.parentid?a.parentid:0;if(1==a.type){a=this._getVariableFromInstance(f,a);if(!a){c&&c(Error("no such variable"));return}a.parentid&&(e=a.parentid)}var g;switch(parseInt(a.type)){case 2:switch(parseInt(a.valuetype)){case 0:"on"==d?g=!0:"off"==d&&(g=!1);break;case 1:"setValue"==d&&(g=parseInt(b.ext));break;case 2:"setValue"==
d&&(g=parseFloat(b.ext));break;case 3:"setValue"==d&&(g=b.ext)}break;case 3:"run"==d&&(g=0);break;default:c&&c(Error("device type not supported"));return}if(null==g||"undefined"==typeof g)c&&c(Error("command invalid"));else if(this.webid){var h=this;d="WFC_Execute";e=[parseInt(this.webid),parseInt(e),parseInt(f),g];"5.0"==this.ver&&(d="RequestAction",e=[parseInt(f),g]);this._doRequest(d,e,function(a){if(!a)var d=Error("http requeset error");else if(a.error&&(h._logger.log("trace","execute command error:"+
JSON.stringify(a)),d=Error(a.error),a.errorCode)){"run"==b.value?(a="IPS_RunScript",d=[parseInt(f)]):(a="SetValue",d=[parseInt(f),g]);h._doRequest(a,d,function(a){var b;a?a.error&&(b=Error(a.error)):b=Error("http requeset error");c&&c(b)});return}c&&c(d)})}else c&&c(Error("no web front object id"))}else c&&c(Error("argument invalid"))};
xnm.aio.symcon.Server.prototype.getStatesCreator=function(a,b,c){if(b&&0!=b.length){a=!0;for(var d={},f={},e=0;e<b.length;e++)if(b[e]&&b[e].device&&b[e].id){var g=b[e].device.objectid,h=b[e].status.value,k=b[e].status.value.indexOf("#");0<k&&(h=b[e].status.value.substr(k+1));1==b[e].device.type&&b[e].status.value&&0<k&&(g=b[e].status.value.substr(0,k));g&&(a=!1,"stateF"==h?(d[g]||(d[g]=[]),d[g].push(b[e])):(f[g]||(f[g]=[]),f[g].push(b[e])))}if(a)c&&c(null,[]);else{var l=this;this._getNextState(0,
Object.keys(f),{},function(a,b){if(a)c&&c(a);else{var e=[];if(b)for(var g in b)if(b.hasOwnProperty(g)&&(a=f[g])&&0<a.length)for(var h=0;h<a.length;h++){var k=l._resolveState(a[h].device,a[h].status,b[g]);null!=k&&"undefined"!=typeof k&&e.push({id:a[h].id,status:k})}l._getNextFormattedState(0,Object.keys(d),{},function(a,b){if(!a&&b)for(var f in b)if(b.hasOwnProperty(f)&&(a=d[f])&&0<a.length)for(var g=0;g<a.length;g++){var h=l._resolveState(a[g].device,a[g].status,b[f]);null!=h&&"undefined"!=typeof h&&
e.push({id:a[g].id,status:h})}c&&c(null,e)})}})}}else c&&c(null,[])};
xnm.aio.symcon.Server.prototype._resolveState=function(a,b,c){if(!a||!b||null==c||"undefined"==typeof c)return null;var d=!1;"stateF"==b.value&&(d=!0);var f=b.value.indexOf("#");0<f&&"stateF"==b.value.substr(f+1)&&(d=!0);if(1==a.type){var e=a.objectid;0<f&&(e=b.value.substr(0,f));a=this._getVariableFromInstance(e,a);if(!a)return null}if(d)return c;switch(parseInt(a.valuetype)){case 0:if("string"==typeof c)if("true"==c.toLowerCase())c=!0;else if("false"==c.toLowerCase())c=!1;else return null;return c?
"on":"off";case 1:return parseInt(c);case 2:return parseFloat(c).toFixed(2);case 3:return c.toString();default:return null}};xnm.aio.symcon.Server.prototype._getNextState=function(a,b,c,d){if(a==b.length)d&&d(null,c);else{var f=this,e=b[a];"string"==typeof e&&(e=parseInt(e));this.getState({id:e},!1,function(e,h){e&&1==e._code?d&&d(e):(e||null==h||"undefined"==typeof h||(c[b[a]]=h),a+=1,f._getNextState(a,b,c,d))})}};
xnm.aio.symcon.Server.prototype._getNextFormattedState=function(a,b,c,d){if(a==b.length)d&&d(null,c);else{var f=this,e=b[a];"string"==typeof e&&(e=parseInt(e));this.getState({id:e},!0,function(e,h){e&&1==e._code?d&&d(e):(e||null==h||"undefined"==typeof h||(c[b[a]]=h),a+=1,f._getNextFormattedState(a,b,c,d))})}};xnm.aio.symcon.Server.prototype.toJSON=function(){return{sys:xnm.aio.symcon.DM.SYS,ip:this.ip,port:this.port,username:this.user,password:this.password,webid:this.webid,webpwd:this.webpwd,ver:this.ver}};
xnm.aio.symcon.Server.prototype.equalsTo=function(a){return a&&a instanceof xnm.aio.symcon.Server?this.ip==a.ip&&this.port==a.port&&this.user==a.user&&this.password==a.password:!1};
xnm.aio.symcon.DM=function(){var a=function(a,c){this.code=a;this.message=c;this.stack=Error().stack};a.prototype=Error();a.prototype.name="IPSymconDMError";a.prototype.code=0;a.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6};return{SYS:"ipsync",getGatewayType:function(){return{sys:this.SYS,name:"IP-Symcon",port:82}},createGateway:function(b,c,d){c=a.ERROR_CODE;b?b.ip?b.port?b.password?d(null,b):d(new a(c.INVALID,"password is invalid")):d(new a(c.INVALID,
"port is invalid")):d(new a(c.INVALID,"ip is invalid")):d(new a(c.INVALID,"info is invalid"))},updateGateway:function(b,c,d,f){b=a.ERROR_CODE;c?c.ip?c.port?c.password?f(null,c):f(new a(b.INVALID,"password is invalid")):f(new a(b.INVALID,"port is invalid")):f(new a(b.INVALID,"ip is invalid")):f(new a(b.INVALID,"update is invalid"))},deleteGateway:function(a,c,d){d()},createDevice:function(b,c,d){var f=a.ERROR_CODE;if(b)if(b.gateway)if(c.data&&c.data.gateways&&0!==c.data.gateways.length){c=c.data.gateways;
var e;for(e=0;e<c.length;e++)if(c[e].index===b.gateway){var g=c[e];break}g?b.type?b.objectid?d(null,b):d(new a(f.INVALID,"address is invalid")):d(new a(f.INVALID,"type is invalid")):d(new a(f.NOT_FOUND,"gateway with index "+b.gateway+" not exists"))}else d(new a(f.NOT_FOUND,"gateway with index "+b.gateway+" not exists"));else d(new a(f.INVALID,"gateway is invalid"));else d(new a(f.INVALID,"info is invalid"))},updateDevice:function(b,c,d){var f=a.ERROR_CODE;if(b)if(b.gateway){c=c.data.gateways;var e;
for(e=0;e<c.length;e++)if(c[e].index===b.gateway){var g=c[e];break}g?b.type?b.objectid?d(null,b):d(new a(f.INVALID,"address is invalid")):d(new a(f.INVALID,"type is invalid")):d(new a(f.NOT_FOUND,"gateway with index "+b.gateway+" not exists"))}else d(new a(f.INVALID,"gateway is invalid"));else d(new a(f.INVALID,"info is invalid"))},deleteDevice:function(a,c,d){d()},getCommandStatusMap:function(a){var b=function(a){if(null==a.valuetype||"undefined"==typeof a.valuetype)return null;switch(parseInt(a.valuetype)){case 0:var b=
{command:[{type:"enum",name:"on",ref:{value:"on"}},{type:"enum",name:"off",ref:{value:"off"}}],status:[{type:"enum",name:"status",ref:{value:"state",options:["off","on"]}},{type:"string",name:"formatted status",ref:{value:"stateF"}}]};break;case 1:b={command:[{type:"int",name:"set value",ref:{value:"setValue",ext:"%d"}}],status:[{type:"int",name:"status",ref:{value:"state",ext:"%d"}},{type:"string",name:"formatted status",ref:{value:"stateF"}}]};break;case 2:b={command:[{type:"float",name:"set value",
ref:{value:"setValue",ext:"%f"}}],status:[{type:"float",name:"status",ref:{value:"state",ext:"%f"}},{type:"string",name:"formatted status",ref:{value:"stateF"}}]};break;case 3:b={command:[{type:"string",name:"set value",ref:{value:"setValue",ext:"%s"}}],status:[{type:"string",name:"status",ref:{value:"state",ext:"%s"}}]};break;default:return null}b&&(b.command&&b.command.forEach(function(b){b.name=a.name?a.name+" "+b.name:b.name;b.ref.value=a.objectid+"#"+b.ref.value}),b.status&&b.status.forEach(function(b){b.name=
a.name?a.name+" "+b.name:b.name;b.ref.value=a.objectid+"#"+b.ref.value}));return b};if(null==a.type||"undefined"==typeof a.type)return null;switch(parseInt(a.type)){case 1:if(a.variables){var d=[],f=[];a.variables.forEach(function(a){(a=b(a))&&a.command&&(d=d.concat(a.command));a&&a.status&&(f=f.concat(a.status))});return{command:d,status:f}}return null;case 2:return b(a);case 3:return{command:[{type:"enum",name:"run",ref:{value:"run"}}]};default:return null}},applyUIFilter:function(a,c){var b=function(a,
b){if("*"==a)return!0;for(var c=!1,d=0;d<a.length;d++)if(a[d]==b){c=!0;break}return c},f=function(a,c,d){var e=[];switch(d.catagory){case "command":a.command&&a.command.forEach(function(a){b(d.elems,a.type)&&(a=JSON.parse(JSON.stringify(a)),e.push(a))});break;case "status":a.status&&a.status.forEach(function(a){b(d.elems,a.type)&&(a=JSON.parse(JSON.stringify(a)),e.push(a))})}return e},e=function(a,b){var c=[],d=xnm.aio.symcon.DM.getCommandStatusMap(a);d&&(a=f(d,a,b),c=c.concat(a));return c};if(!a.sys)return null;
var g=JSON.parse(JSON.stringify(a)),h=null;switch(c.catagory){case "command":h=e(a,c);g.command=h;break;case "status":h=e(a,c);g.status=h;break;default:return null}return h&&0!=h.length?g:null}}}();xnm.aio.symcon.Handler=function(){};xnm.aio.symcon.Handler.prototype.Server=xnm.aio.symcon.Server;xnm.aio.symcon.Handler.prototype.getStateValues=function(a,b){return(new xnm.aio.symcon.Server).getStateValues(a.type,b)};xnm.aio.symcon.Handler.prototype.getDeviceCommandList=function(a,b){return[]};
xnm.aio.symcon.Handler.prototype.TYPE_BOOL=xnm.aio.symcon.TYPE_BOOL;xnm.aio.symcon.Handler.prototype.TYPE_INT=xnm.aio.symcon.TYPE_INT;xnm.aio.symcon.Handler.prototype.TYPE_FLOAT=xnm.aio.symcon.TYPE_FLOAT;xnm.aio.symcon.Handler.prototype.TYPE_STRING=xnm.aio.symcon.TYPE_STRING;xnm.aio.symcon.Handler.prototype.devicemanager=xnm.aio.symcon.DM;xnm.aio.symcon.Handler.prototype.registModule=function(a){a.register(this.devicemanager.SYS,"symcon")};
xnm.aio.symcon.Handler.prototype.resolveGateway=function(a){return a&&a.ip&&a.password?new xnm.aio.symcon.Server(a.ip,a.port,a.username,a.password,a.webid,a.webpwd,a.ver):null};xnm.aio.symcon.Handler.prototype.getWebfronts=function(a,b){(a=this.resolveGateway(a))?a._scanWebfront(function(a,d){b&&b(a,d)}):b&&b(Error("gateway json invalid"))};
xnm.aio.symcon.Handler.prototype.getDeviceList=function(a,b){(a=this.resolveGateway(a))?a.scanObjects(null,function(a,d){var c={webfront:[],devices:[]},e;if(!a&&d){for(e in d.instances)d.instances.hasOwnProperty(e)&&c.devices.push(d.instances[e]);for(e in d.scripts)d.scripts.hasOwnProperty(e)&&c.devices.push(d.scripts[e]);for(e in d.variables)d.variables.hasOwnProperty(e)&&c.devices.push(d.variables[e]);c.webfront=d.webfront}b&&b(a,c)}):b&&b(Error("gateway json invalid"))};
xnm.aio.symcon.Handler.prototype.getDeviceCommands=function(a,b){a=(a=xnm.aio.symcon.DM.applyUIFilter(a,{catagory:"command",elems:"*"}))?a.command:[];b&&b(null,a)};xnm.aio.symcon.Handler.prototype.getDeviceStatus=function(a,b){a=(a=xnm.aio.symcon.DM.applyUIFilter(a,{catagory:"status",elems:"*"}))?a.status:[];b&&b(null,a)};xnm.aio.symcon.Handler.prototype.doCommand=function(a,b,c,d){(a=this.resolveGateway(a))?a.executeCommandCreator(b,c,function(a){d&&d(a)}):d&&d(Error("gateway json invalid"))};
xnm.aio.symcon.Handler.prototype.doStatus=function(a,b,c,d,f){(b=this.resolveGateway(b))?b.getStatesCreator(null,[{id:a,device:c,status:d}],function(a,b){a?f&&f(a):f&&f(null,b[0])}):f&&f(Error("gateway json invalid"))};"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new xnm.aio.symcon.Handler);
