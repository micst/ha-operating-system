var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(e,b,a){e instanceof String&&(e=String(e));for(var c=e.length,d=0;d<c;d++){var f=e[d];if(b.call(a,f,d,e))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,b,a){e!=Array.prototype&&e!=Object.prototype&&(e[b]=a.value)};$jscomp.getGlobal=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,e];for(var b=0;b<e.length;++b){var a=e[b];if(a&&a.Math==Math)return a}return globalThis};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(e,b,a,c){if(b){a=$jscomp.global;e=e.split(".");for(c=0;c<e.length-1;c++){var d=e[c];d in a||(a[d]={});a=a[d]}e=e[e.length-1];c=a[e];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(a,e,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(e){return e?e:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");var xnm=xnm||{};xnm.aio=xnm.aio||{};xnm.aio.upnp=xnm.aio.upnp||{};
xnm.aio.upnp.Player=function(){var e=function(b){this._logger="undefined"!=typeof require&&require?require("x.logger.js").getLogger("xnm.aio.bose.SoundTouch"):{log:{}};this._renderer=null;b&&b.ip&&b.port&&b.uuid&&b.avTransport&&b.renderingControl&&(this._renderer=this._getRenderer(b.ip,b.port,b.uuid,b.avTransport,b.renderingControl))};e.prototype.getIP=function(){return this._renderer?this._renderer.ip:null};e.prototype.setIP=function(b){this._renderer&&(this._renderer.ip=b)};e.prototype.getPort=
function(){return this._renderer?this._renderer.port:null};e.prototype.setPort=function(b){this._renderer&&(this._renderer.port=b)};e.prototype.getUUID=function(){return this._renderer?this._renderer.uuid:null};e.prototype.getPlayInfo=function(b){this._renderer?this._renderer.getPlayInfo(function(a,c){b&&b(a,c)}):b&&b(Error("no renderer"))};e.prototype.play=function(b,a,c){if(b&&a&&a["class"]&&a.id)if(this._renderer){var d=this;b.browseMetaData(a.id,function(f,e){f?c&&c(f):0!=a["class"].indexOf("object.container")||
a.res&&a.res.url?a.res&&a.res.url?d._renderer.playResource({url:a.res.url},e.result,c):c&&c(Error("resource url invalid")):b.uuid?d._renderer.playContainer({containerID:a.id,server_uuid:b.uuid},e.result,c):c&&c(Error("media server uuid invalid"))})}else c&&c(Error("renderer not inited"));else c&&c(Error("play obj invalid"))};e.prototype.browser=function(b,a,c,d,f){b?(a||(a=0),c||(c=0),d||(d=0),b.browseChildren(a,c,d,null,function(a,b,c){f&&f(a,b,c)})):f&&f(Error("play obj invalid"))};e.prototype.executeCommandCreator=
function(b,a,c){a&&a.value?this._executeCommand(a.value,a.ext,function(a){c&&c(a)}):c&&c(Error("command value is empty"))};e.prototype.getStatesCreator=function(b,a,c){this._getStates(function(b,f){if(b)c&&c(b);else{b=[];for(var d=0;d<a.length;d++){var e=a[d];if(e&&e.id&&e.status){var g="?";switch(e.status.value){case "power":case "muted":case "volume":case "repeatMode":case "shuffleMode":case "playState":case "durationS":case "positionS":case "bass":g=f[e.status.value];break;case "artist":case "title":case "album":case "radio":(g=
f[e.status.value])||(g="")}if("undefined"==typeof g||null==g)g="?";b.push({id:e.id,status:g})}}c&&c(null,b)}})};e.prototype._executeCommand=function(b,a,c){if(this._renderer){var d=this;switch(b){case "play":this._clickKey("PLAY",c);break;case "pause":this._clickKey("PAUSE",c);break;case "tooglePlay":this._clickKey("PLAY_PAUSE",c);break;case "stop":this._clickKey("STOP",c);break;case "previous":this._clickKey("PREV_TRACK",c);break;case "next":this._clickKey("NEXT_TRACK",c);break;case "togglePower":this._clickKey("POWER",
c);break;case "toggleMute":this._clickKey("MUTE",c);break;case "volumeUp":this._clickKey("VOLUME_UP",c);break;case "volumeDown":this._clickKey("VOLUME_DOWN",c);break;case "setVolume":if("undefined"==typeof a||null==a){c&&c(Error("volume value invalid"));break}a=parseInt(a);100<a&&(a=100);0>a&&(a=0);this._setVolume(a,c);break;case "thumbUp":this._clickKey("THUMBS_UP",c);break;case "thumbDown":this._clickKey("THUMBS_DOWN",c);break;case "bookmark":this._clickKey("BOOKMARK",c);break;case "preset":if(!a){c&&
c(Error("preset value invalid"));break}this._clickKey("PRESET_"+a,c);break;case "shuffleOn":this._clickKey("SHUFFLE_ON",c);break;case "shuffleOff":this._clickKey("SHUFFLE_OFF",c);break;case "toggleShuffle":this._getNowPlaying(function(b,a){b?c&&c(b):a&&a.shuffleSetting?(b="SHUFFLE_ON","SHUFFLE_ON"==a.shuffleSetting&&(b="SHUFFLE_OFF"),d._clickKey(b,c)):c&&c(Error("no shuffle setting"))});break;case "setRepeatMode":if(!a){c&&c(Error("play mode value invalid"));break}this._clickKey(a,c);break;case "addFav":this._clickKey("ADD_FAVORITE",
c);break;case "removeFav":this._clickKey("REMOVE_FAVORITE",c);break;case "bassUp":case "bassDown":if("undefined"==typeof a||null==a){c&&c(Error("seek value invalid"));break}this._getBass(function(a,e){if(a)c&&c(a);else if(e&&"undefined"!=typeof e.actualbass&&null!=e.actualbass){a=e.actualbass;a="bassUp"==b?a+1:a-1;if(this.bass&&(f=this.bass.indexOf("-",1),-1!=f)){e=this.bass.substring(0,f);var h=this.bass.substr(f+1);e=parseInt(e);h=parseInt(h);a<e&&(a=e);a>h&&(a=h)}d._setBass(a,c)}else c&&c(Error("no bass info"))});
break;case "setBass":if("undefined"==typeof a||null==a){c&&c(Error("volume value invalid"));break}a=parseInt(a);if(this.bass){var f=this.bass.indexOf("-",1);if(-1!=f){var e=this.bass.substring(0,f),k=this.bass.substr(f+1);e=parseInt(e);k=parseInt(k);a<e&&(a=e);a>k&&(a=k)}}this._setBass(a,c);break;default:b&&"select:"==b.substr(0,7)?(e=b.substr(7),f=e.indexOf("@"),a=e.substring(0,f),e=e.substr(f+1),d._setSource(a,e,c)):c&&c(Error("unknown command"))}}else c&&c(Error("renderer not initialized"))};e.prototype._getStates=
function(b){var a=function(){d--;0==d&&b&&b(null,c)},c={},d=3;this._getBass(function(b,d){!b&&d&&(c.bass=d.actualbass);a()});this._getVolume(function(b,d){!b&&d&&(c.volume=d.actualvolume,c.muted=d.muteenabled);a()});this._getNowPlaying(function(b,d){!b&&d&&(c.power="STANDBY"==d.source?"off":"on",d.repeatSetting&&(c.repeatMode=d.repeatSetting),d.shuffleSetting&&(c.shuffleMode=d.shuffleSetting),d.playStatus&&(c.playState=d.playStatus),d.duration&&(c.durationS=d.duration),d.position&&(c.positionS=d.position),
d.position&&(c.positionS=d.position),d.track&&(c.title=d.track),d.stationName&&(c.radio=d.stationName),d.artist&&(c.artist=d.artist),d.album&&(c.album=d.album));a()})};e.prototype._getRenderer=function(b,a,c,d,e){var f=require("xnm.aio.upnp.js");if(f.discovery&&f.discovery._player&&(f=f.discovery._player[c])&&f._renderer)return f._renderer;f=new (require("x.upnp.js").MediaRenderer);f.init(b,a,c,{avTransport:d,renderingControl:e});return f};e.prototype._clickKey=function(b,a){var c=this;this._pressKey(b,
function(d){d?a&&a(d):c._releaseKey(b,function(b){a&&a(b)})})};e.prototype._getInfo=function(b){var a=this;this._sendRequest("GET","/info",null,function(c,d){c?b&&b(c):(c=d.find("info"))&&c[0]?(c=$(c[0]),a.mac=c.attr("deviceID"),(c=c.find("name"))&&c[0]&&(a.name=$(c[0]).text()),b&&b(null,{name:a.name,mac:a.mac})):b&&b(Error("get info xml invalid"))})};e.prototype._pressKey=function(b,a){this._sendRequest("POST","/key",'<key state="press" sender="Gabbo">'+b+"</key>",a)};e.prototype._releaseKey=function(b,
a){this._sendRequest("POST","/key",'<key state="release" sender="Gabbo">'+b+"</key>",a)};e.prototype._getSources=function(b){var a=this;this._sendRequest("GET","/sources",null,function(c,d){if(c)b&&b(c);else{var e=[];d.find("sourceItem").each(function(){var a=$(this);e.push({source:a.attr("source"),sourceAccount:a.attr("sourceAccount")?a.attr("sourceAccount"):null,isLocal:a.attr("isLocal"),name:a.text()?a.text():null})});a.sources=e;b&&b(null,e)}})};e.prototype._setSource=function(b,a,c){b='<ContentItem source="'+
b+'"';a&&(b+=' sourceAccount="'+a+'"');this._sendRequest("POST","/select",b+"></ContentItem>",c)};e.prototype._setBass=function(b,a){this._sendRequest("POST","/bass","<bass>"+b+"</bass>",a)};e.prototype._getBass=function(b){this._sendRequest("GET","/bass",null,function(a,c){if(a)b&&b(a);else{var d={},e=c.find("targetbass");e&&e[0]&&(d.targetbass=parseInt($(e[0]).text()));(e=c.find("actualbass"))&&e[0]&&(d.actualbass=parseInt($(e[0]).text()));b&&b(a,d)}})};e.prototype._getBassCap=function(b){var a=
this;this._sendRequest("GET","/bassCapabilities",null,function(c,d){if(c)b&&b(c);else if((c=d.find("bassAvailable"))&&c[0])if((c=$(c[0]).text())&&"false"!=c.toLowerCase()){c=0;var e=d.find("bassMin");e&&e[0]&&(c=$(e[0]).text());e=100;(d=d.find("bassMax"))&&d[0]&&(e=$(d[0]).text());a.bass=c+"-"+e;b&&b(null,{bass:a.bass})}else b&&b(null,null);else b&&b(Error("get bass cap xml invalid"))})};e.prototype._getZone=function(b){this._sendRequest("GET","/getZone",null,function(a,c){if(a)b&&b(a);else{var d=
{};if((a=c.find("zone"))&&a[0]){c=$(a[0]).attr("master");if(!c){b&&b(null,d);return}d.master=c}$(a[0]).find("member").each(function(){var a=$(this),b=a.attr("ipaddress");a=a.text();b&&a&&(d.members||(d.members={}),d.members[a]=b)});b&&b(null,d)}})};e.prototype._setZone=function(b,a,c){b='<zone master="'+b+'" senderIPAddress="0.0.0.0">';for(var d in a)a.hasOwnProperty(d)&&a[d]&&(b+='<member ipaddress="'+a[d]+'">'+d+"</member>");this._sendRequest("POST","/setZone",b+"</zone>",c)};e.prototype._getVolume=
function(b){this._sendRequest("GET","/volume",null,function(a,c){if(a)b&&b(a);else{var d={},e=c.find("targetvolume");e&&e[0]&&(d.targetvolume=parseInt($(e[0]).text()));(e=c.find("actualvolume"))&&e[0]&&(d.actualvolume=parseInt($(e[0]).text()));(e=c.find("muteenabled"))&&e[0]&&(d.muteenabled=$(e[0]).text());b&&b(a,d)}})};e.prototype._setVolume=function(b,a){this._sendRequest("POST","/volume","<volume>"+b+"</volume>",a)};e.prototype._getNowPlaying=function(b){this._sendRequest("GET","/now_playing",
null,function(a,c){if(a)b&&b(a);else{a={};var d=c.find("nowPlaying");if(d&&d[0]){var e=$(d[0]).getAttributes();a=JSON.parse(JSON.stringify(e))}(d=c.find("ContentItem"))&&d[0]&&(e=$(d[0]).getAttributes(),a.content=JSON.parse(JSON.stringify(e)),(e=$(d[0]).find("itemName"))&&e[0]&&(a.content.itemName=$(e[0]).text()));(d=c.find("track"))&&d[0]&&(a.track=$(d[0]).text());(d=c.find("artist"))&&d[0]&&(a.artist=$(d[0]).text());(d=c.find("album"))&&d[0]&&(a.album=$(d[0]).text());(d=c.find("stationName"))&&
d[0]&&(a.stationName=$(d[0]).text());(d=c.find("art"))&&d[0]&&(a.artImageStatus=$(d[0]).attr("artImageStatus"),a.art=$(d[0]).text());(d=c.find("playStatus"))&&d[0]&&(a.playStatus=$(d[0]).text());(d=c.find("description"))&&d[0]&&(a.description=$(d[0]).text());(d=c.find("stationLocation"))&&d[0]&&(a.description=$(d[0]).text());(d=c.find("time"))&&d[0]&&(a.duration=$(d[0]).attr("total"),a.position=$(d[0]).text());(d=c.find("shuffleSetting"))&&d[0]&&(a.shuffleSetting=$(d[0]).text());(d=c.find("repeatSetting"))&&
d[0]&&(a.repeatSetting=$(d[0]).text());b&&b(null,a)}})};e.prototype._sendRequest=function(b,a,c,d){this._doRequest(this.getIP(),8090,b,a,c,function(a,b){if(a)d&&d(a);else try{var c=$($.parseXML(b)),e=c.find("error");if(e&&e[0]){var f=$(e[0]),h=f.text(),m=f.attr("name");d&&d(Error(h+":"+m))}else d&&d(null,c)}catch(n){d&&d(n)}})};e.prototype._doRequest=function(b,a,c,d,e,h){var f=this;b="http://"+b+":"+a+d;this._logger.log("trace","send "+c+" to url:"+b);e&&this._logger.log("trace","with data "+e);
var g=h;h={url:b,type:c,timeout:2E3,contentType:"text/xml",dataType:"text",cache:!0,success:function(a){f._logger.log("trace","http request success:"+a);g&&(g(null,a),g=null)},error:function(a,b){a="http request error:"+(a?a.status:"0")+"-"+b;f._logger.log("trace",a);g&&(g(Error(a)),g=null)}};"post"==c.toLowerCase()&&e&&(h.data=e);$.ajax(h)};e.prototype.toJSON=function(){return{sys:"upnp",ip:this.getIP(),port:this.getPort(),uuid:this.getUUID(),name:this._renderer?this._renderer.name:null,model:this._renderer?
this._renderer.modelName:null,modelDescription:this._renderer?this._renderer.modelDescription:null,manufacturer:this._renderer?this._renderer.manufacturer:null,avTransport:this._renderer?this._renderer.avTransport:null,renderingControl:this._renderer?this._renderer.renderingControl:null,connectionManager:this._renderer?this._renderer.connectionManager:null}};e.prototype.equalsTo=function(b){return b&&b instanceof SoundTouch?this.getIP()==b.getIP()&&this.getPort()==b.getPort():!1};return e}();
xnm.aio.upnp.InMemoryPlayList=function(){return function(){}}();
xnm.aio.upnp.Discovery=function(){var e=function(){this._logger="undefined"!=typeof require&&require?require("x.logger.js").getLogger("xnm.aio.bose.Discovery"):{log:{}};this._upnpCB=null;this._mediaServer={};this._player={};this._searchCB=[];this._autoSearchTimeout=null;this.search(null)};e.prototype.getBufferedPlayer=function(b){return this._player[b]};e.prototype.getBufferedPlayers=function(){var b=[],a;for(a in this._player)this._player.hasOwnProperty(a)&&b.push(this._player[a]);return b};e.prototype.getBufferedMediaServers=
function(){var b=[],a;for(a in this._mediaServer)this._mediaServer.hasOwnProperty(a)&&b.push(this._mediaServer[a]);return b};e.prototype.search=function(b){var a=this._searchCB.length;b&&-1==this._searchCB.indexOf(b)&&this._searchCB.push(b);if(0==a){this._autoSearchTimeout&&(clearTimeout(this._autoSearchTimeout),this._autoSearchTimeout=null);this._search();var c=this;setTimeout(function(){c._autoSearchTimeout=setTimeout(function(){c._logger.log("trace","auto search timeout, search again");c.search(null)},
6E4);var a=c._searchCB;c._searchCB=[];a.forEach(function(a){a&&a()})},5E3)}};e.prototype._search=function(){if(!this._upnpCB){var b=this;this._upnpCB=function(a){b._findUpnpDevice(a)}}this._mediaServer={};this._player={};var a=require("x.upnp.js").getDiscoveryService();a.addCallback("upnp:rootdevice",this._upnpCB);a.discoverTarget("upnp:rootdevice")};e.prototype._findUpnpDevice=function(b){if(b){var a=b.uuid;switch(b.deviceType){case "urn:schemas-upnp-org:device:MediaServer:1":this._logger.log("trace",
"find media server:"+b.name+" @"+b.ip);this._mediaServer[a]=b;break;case "urn:schemas-upnp-org:device:MediaRenderer:1":this._logger.log("trace","find media renderer:"+b.name+" @"+b.ip);var c=new xnm.aio.upnp.Player;c._renderer=b;this._player[a]=c}}};return e}();
xnm.aio.upnp.DM=function(){var e={command:[{type:"enum",name:"play",ref:{value:"play"}},{type:"enum",name:"pause",ref:{value:"pause"}},{type:"enum",name:"paly/pause",ref:{value:"tooglePlay"}},{type:"enum",name:"stop",ref:{value:"stop"}},{type:"enum",name:"previous",ref:{value:"previous"}},{type:"enum",name:"next",ref:{value:"next"}},{type:"enum",name:"toggle power",ref:{value:"togglePower"}},{type:"enum",name:"toggle mute",ref:{value:"toggleMute"}},{type:"enum",name:"volume up",ref:{value:"volumeUp"}},
{type:"enum",name:"volume down",ref:{value:"volumeDown"}},{type:"int",name:"set volume",ref:{value:"setVolume",ext:"%d",extMeta:"0-100"}},{type:"enum",name:"thumb up",ref:{value:"thumbUp"}},{type:"enum",name:"thumb down",ref:{value:"thumbDown"}},{type:"enum",name:"bookmark",ref:{value:"bookmark"}},{type:"enum",name:"preset",ref:{value:"preset",ext:"%e",extMeta:"123456".split("")}},{type:"enum",name:"shuffle on",ref:{value:"shuffleOn"}},{type:"enum",name:"shuffle off",ref:{value:"shuffleOff"}},{type:"enum",
name:"toggle shuffle",ref:{value:"toggleShuffle"}},{type:"enum",name:"set repeat mode",ref:{value:"setRepeatMode",ext:"%e",extMeta:["REPEAT_OFF","REPEAT_ONE","REPEAT_ALL"]}},{type:"enum",name:"add to favorite",ref:{value:"addFav"}},{type:"enum",name:"remove from favorite",ref:{value:"removeFav"}}],status:[{type:"enum",name:"power",ref:{value:"power",options:["on","off"]}},{type:"enum",name:"muted",ref:{value:"muted",options:["true","false"]}},{type:"int",name:"volume",ref:{value:"volume",extMeta:"0-100"}},
{type:"enum",name:"repeat mode",ref:{value:"repeatMode",options:["REPEAT_OFF","REPEAT_ONE","REPEAT_ALL"]}},{type:"enum",name:"shuffle mode",ref:{value:"shuffleMode",options:["SHUFFLE_ON","SHUFFLE_OFF"]}},{type:"string",name:"play state",ref:{value:"playState",options:["PLAY_STATE","PAUSE_STATE","STOP_STATE","BUFFERING_STATE","INVALID_PLAY_STATUS"]}},{type:"int",name:"track duration (seconds)",ref:{value:"durationS"}},{type:"int",name:"track position (seconds)",ref:{value:"positionS"}},{type:"string",
name:"radio station",ref:{value:"radio"}},{type:"string",name:"artist",ref:{value:"artist"}},{type:"string",name:"title",ref:{value:"title"}},{type:"string",name:"album",ref:{value:"album"}}]},b=function(a,b){this.code=a;this.message=b;this.stack=Error().stack};b.prototype=Error();b.prototype.name="UpnpDMError";b.prototype.code=0;b.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6};return{SYS:"upnp",getIPDeviceType:function(){return[{sys:this.SYS,name:"UPnP/DLNA Player"}]},
createDevice:function(a,c,d){c=b.ERROR_CODE;a?a.type?a.ip?a.port?a.uuid?d(null,a):d(new b(c.INVALID,"uuid is invalid")):d(new b(c.INVALID,"port is invalid")):d(new b(c.INVALID,"ip is invalid")):d(new b(c.INVALID,"type is invalid")):d(new b(c.INVALID,"info is invalid"))},updateDevice:function(a,c,d){c=b.ERROR_CODE;a?a.type?a.ip?a.port?a.uuid?d(null,a):d(new b(c.INVALID,"uuid is invalid")):d(new b(c.INVALID,"port is invalid")):d(new b(c.INVALID,"ip is invalid")):d(new b(c.INVALID,"type is invalid")):
d(new b(c.INVALID,"info is invalid"))},deleteDevice:function(a,b,d){d()},applyUIFilter:function(a,b,d){var c=function(a,b){if("*"==a)return!0;for(var c=!1,d=0;d<a.length;d++)if(a[d]==b){c=!0;break}return c},e=function(a,b,d){var e=[];switch(d.catagory){case "command":a.command&&a.command.forEach(function(a){c(d.elems,a.type)&&(a=JSON.parse(JSON.stringify(a)),e.push(a))});break;case "status":a.status&&a.status.forEach(function(a){c(d.elems,a.type)&&(a=JSON.parse(JSON.stringify(a)),e.push(a))})}return e},
k=function(a,b){var c=[],f=xnm.aio.bose.DM.getCommandStatusMap(a,d);f&&(a=e(f,a,b),c=c.concat(a));return c};if(!a.sys)return null;var g=JSON.parse(JSON.stringify(a)),l=null;switch(b.catagory){case "command":l=k(a,b);g.command=l;break;case "status":l=k(a,b);g.status=l;break;default:return null}return l&&0!=l.length?g:null},getCommandStatusMap:function(a,b){var c=JSON.parse(JSON.stringify(e));a&&a.bass&&(c.command.push({type:"enum",name:"bass up",ref:{value:"bassUp"}}),c.command.push({type:"enum",name:"bass down",
ref:{value:"bassDown"}}),c.command.push({type:"int",name:"set bass",ref:{value:"setBass",ext:"%d",extMeta:a.bass}}),c.status.push({type:"int",name:"bass",ref:{value:"bass",extMeta:a.bass}}));a&&a.sources&&a.sources.forEach(function(a){if(a&&"true"==a.isLocal){var b=a.source;a.name&&(b=a.name);var d=a.sourceAccount?a.sourceAccount:"";a.source&&c.command.push({type:"enum",name:"select "+b,ref:{value:"select:"+a.source+"@"+d}})}});return c}}}();
xnm.aio.upnp.Handler=function(){var e=function(){this.discovery=new xnm.aio.upnp.Discovery};e.prototype.devicemanager=xnm.aio.upnp.DM;e.prototype.Player=xnm.aio.upnp.Player;e.prototype.registModule=function(b){b.register(xnm.aio.upnp.DM.SYS,"upnp")};e.prototype.resolveDevice=function(b){if(!b)return null;var a=null;b.uuid&&(a=this.discovery.getBufferedPlayer(b));return a?a:b.ip&&b.port&&b.uuid&&b.avTransport&&b.renderingControl?new xnm.aio.upnp.Player(b):null};e.prototype.getDeviceCommands=function(b,
a){b=(b=this.devicemanager.applyUIFilter(b,{catagory:"command",elems:"*"}))?b.command:[];a&&a(null,b)};e.prototype.getDeviceStatus=function(b,a){b=(b=this.devicemanager.applyUIFilter(b,{catagory:"status",elems:"*"}))?b.status:[];a&&a(null,b)};e.prototype.doCommand=function(b,a,c){var d=this.resolveDevice(b);d?d.executeCommandCreator(b,a,function(a){c&&c(a)}):c&&c(Error("device json format invalid"))};e.prototype.doStatus=function(b,a,c,d){var e=this.resolveDevice(a);e?e.getStatesCreator(null,[{id:b,
device:a,status:c}],function(a,b){a?d&&d(a):d&&d(null,b[0])}):d&&d(Error("device json format invalid"))};e.prototype.discover=function(b){var a=this;this.discovery.search(function(){b&&b(null,a.discovery.getBufferedPlayers())})};e.prototype.getPlayer=function(b,a){if(b&&b.uuid){var c=this.discovery.getBufferedPlayer(b.uuid);if(c)a&&a(null,c);else{var d=this;this.discovery.search(function(){c=d.discovery.getBufferedPlayer(b.uuid);a&&a(null,c)})}}else a&&a(Error("device json invalid"))};e.prototype.getMediaServer=
function(b){var a=this.discovery.getBufferedMediaServers();if(0==a.length){var c=this;this.discovery.search(function(){b&&b(null,c.discovery.getBufferedMediaServers())})}else b&&b(null,a)};return e}();"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new xnm.aio.upnp.Handler);
