var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(d,a,c){d instanceof String&&(d=String(d));for(var b=d.length,e=0;e<b;e++){var f=d[e];if(a.call(c,f,e,d))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,a,c){d!=Array.prototype&&d!=Object.prototype&&(d[a]=c.value)};$jscomp.getGlobal=function(d){d=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,d];for(var a=0;a<d.length;++a){var c=d[a];if(c&&c.Math==Math)return c}return globalThis};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(d,a,c,b){if(a){c=$jscomp.global;d=d.split(".");for(b=0;b<d.length-1;b++){var e=d[b];e in c||(c[e]={});c=c[e]}d=d[d.length-1];b=c[d];a=a(b);a!=b&&null!=a&&$jscomp.defineProperty(c,d,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");var xnm=xnm||{};xnm.aio=xnm.aio||{};xnm.aio.yamaha=xnm.aio.yamaha||{};
xnm.aio.yamaha.AVR=function(){var d=function(a,c,b,e,d){this._logger=require("x.logger.js").getLogger("xnm.aio.yamaha.AVR");this.ip=a;this.port=c;this.port||(this.port="80");this.uuid=b;this.name=e;this.model=d;this.timeout=3E3;this.CommandHandler=null};d.prototype.audioModes="2ch Stereo;5ch Stereo;Surround Decoder;Standard;Spectacle;Sci-Fi;Adventure;Drama;Mono Movie;Sports;Action Game;Roleplaying Game;Hall in Munich;Hall in Vienna;Chamber;Cellar Club;The Roxy Theatre;The Bottom Line;Music Video".split(";");
d.prototype.videoModes="HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link;MULTI CH;PHONO;CD;TV;MD/CD-R;BD/HD DVD;DVD;CBL/SAT;DVR;VCR;V-AUX;DOCK;PC/MCX".split(";");d.prototype.executeCommandCreator=function(a,c,b){if(c&&c.value)if("openNative"==c.value)window&&window.XC&&window.XC.callHost&&window.XCHost&&window.XCHost.getType&&("iOS"==window.XCHost.getType()?window.XC.callHost("SYSTEM","startApp",
{scheme:"jp.co.yamaha.avkk.avcontroller://"}):"Android"==window.XCHost.getType()&&window.XC.callHost("SYSTEM","startApp",{scheme:"com.yamaha.av.avcontroller"})),b&&b();else{a="";c.path&&c.path[0]&&"global"!=c.path[0]&&(a=c.path[0]+":");var e=a+c.value;if("sleep"==c.value){if(!c.ext){b&&b(Error("command sleep ext format invalid"));return}e+=c.ext.replace(/min/g,"")}else if("setInput"==c.value){if(!c.ext){b&&b(Error("command setInput ext format invalid"));return}e=a+c.ext}else if("audioMode"==c.value){if(!c.ext){b&&
b(Error("command audioMode ext format invalid"));return}e=a+c.ext}else if("setTo"==c.value){if(null==c.ext||"undefined"==typeof c.ext){b&&b(Error("command setTo ext format invalid"));return}e+=c.ext}else if("dlgLevel"==c.value){if(null==c.ext||"undefined"==typeof c.ext){b&&b(Error("command dlgLevel ext format invalid"));return}e+=c.ext}else if("setVideoPreset"==c.value){if(null==c.ext||"undefined"==typeof c.ext){b&&b(Error("command setVideoPreset ext format invalid"));return}e+=c.ext}else if("customCMD"==
c.value){if(!c.ext){b&&b(Error("command customCMD ext format invalid"));return}e=a+c.ext}if(c.path&&c.path[0]&&"tuner"==c.path[0]&&(e=c.value,"tunerPreset"==c.value)){if(null==c.ext||"undefined"==typeof c.ext){b&&b(Error("command tunerPreset ext format invalid"));return}e="tuner"+c.ext}this.executeCommand(e,function(a){if(a)b&&b(a);else{if(c.path&&c.path[0]&&"mainzone"==c.path[0]){if("on"==c.value||"off"==c.value||"toggle"==c.value){setTimeout(function(){b&&b()},1E3);return}if("setTo"==c.value||"volumeUp"==
c.value||"volumeDown"==c.value){setTimeout(function(){b&&b()},10);return}}b&&b()}})}else b&&b(Error("command json format invalid"))};d.prototype.getStatesCreator=function(a,c,b){a=[];for(var e=0;e<c.length;e++)if(c[e]&&c[e].status&&c[e].status.path&&c[e].status.path[0]){var d=0;switch(c[e].status.path[0]){case "mainzone":d=1;break;case "zone2":d=2;break;case "zone3":d=3;break;case "zone4":d=4}d&&-1==a.indexOf(d)&&a.push(d)}this.getStates(a,function(a,e){a=[];for(var d=0;d<c.length;d++)if(c[d]&&c[d].id){var f=
"?";if(c[d].status&&c[d].status.value){var g="";c[d].status.path&&c[d].status.path[0]&&"global"!=c[d].status.path[0]&&(g=c[d].status.path[0]);var h=c[d].status.value;e&&g&&e[g]&&e[g][h]&&(f=e[g][h])}a.push({id:c[d].id,status:f})}b&&b(null,a)})};d.prototype._doRequest=function(a,c,b){a='<?xml version="1.0" encoding="utf-8"?><YAMAHA_AV cmd="'+a+'">'+(c+"</YAMAHA_AV>");var d=this;c="http://"+this.ip+":"+this.port+"/YamahaRemoteControl/ctrl";this._logger.log("trace","send data:"+a);var f=b;$.ajax({url:c,
type:"POST",timeout:this.timeout,data:a,dataType:"text",cache:!0,headers:{"Content-Length":a.length},success:function(a){d._logger.log("trace","http request success:"+a);f&&(f(null,a),f=null)},error:function(a,b){b="http request error:"+(a?a.status:"0")+"-"+b;d._logger.log("trace",b);b=Error(b);b.code=a?a.status:0;f&&(f(b),f=null)}})};d.prototype._getStateValue=function(a,c,b){var d=null;a=a.find(c);0<a.length&&(d=$(a[0]).text());d&&b&&(d=d.toLowerCase());return d};d.prototype._parseStates=function(a,
c){var b={};b.power=this._getStateValue(a,"Power_Control Power",!0);"standby"==b.power&&(b.power="off");b.sleep=this._getStateValue(a,"Power_Control Sleep",!0);b.mute=this._getStateValue(a,"Volume Mute",!0);b.mute||(b.mute=this._getStateValue(a,"Vol Mute",!0));var d=this._getStateValue(a,"Volume Lvl Val");d||(d=this._getStateValue(a,"Vol Lvl Val"));b.volume=d?(parseFloat(d)/10).toFixed(1):null;b.input=this._getStateValue(a,"Input Input_Sel");"zone2"!=c&&"zone3"!=c&&"zone4"!=c&&(b.mode=this._getStateValue(a,
"Surround Program_Sel Current Sound_Program"),b.enhancer=this._getStateValue(a,"Surround Program_Sel Current Enhancer",!0),b.straight=this._getStateValue(a,"Surround Program_Sel Current Straight",!0),b.direct=this._getStateValue(a,"Sound_Video Pure_Direct Mode",!0),b.bass=this._getStateValue(a,"Sound_Video Extra_Bass",!0),"auto"==b.bass&&(b.bass="on"),b.ypao_volume=this._getStateValue(a,"Sound_Video YPAO_Volume",!0),"auto"==b.ypao_volume&&(b.ypao_volume="on"),b.dlgLevel=this._getStateValue(a,"Sound_Video Dialogue_Adjust Dialogue_Lvl"),
b.videoPreset=this._getStateValue(a,"Sound_Video HDMI Video Preset_Sel Current",!0),b.videoPreset&&(b.videoPreset=b.videoPreset.replace("preset ","")));return b};d.prototype.getStates=function(a,c){a&&0!=a.length||(a=[1]);var b={},d=0,f=this,g=function(e,k){var h=a[d];!e&&k&&(1==h?b.mainzone=k.mainzone:2==h?b.zone2=k.zone2:3==h?b.zone3=k.zone3:4==h&&(b.zone4=k.zone4));d++;d<a.length?f._getZoneStates(a[d],g):c&&c(null,b)};this._getZoneStates(a[d],g)};d.prototype._getZoneStates=function(a,c){var b=
this;if(1==a){var d="Main_Zone";var f="mainzone"}else 2==a?(d="Zone_2",f="zone2"):3==a?(d="Zone_3",f="zone3"):4==a&&(d="Zone_4",f="zone4");this._doRequest("GET","<"+d+"><Basic_Status>GetParam</Basic_Status></"+d+">",function(a,d){if(a)c&&c(a);else try{var e=$($.parseXML(d));if(e){var g=e.find("Basic_Status");if(!g||0>=g.length)c&&c(Error(f+" status reponse has no basic status tag"));else{var h=$(g[0]);a={};a[f]=b._parseStates(h,f);c&&c(null,a)}}else c&&c(Error(f+" status reponse invalid"))}catch(l){c&&
c(l)}})};d.prototype.executeCommand=function(a,c){var b=null,d=!0,f=null,g=a.indexOf(":");0<g&&(f=a.substr(0,g),a=a.substr(g+1));var h=this;"on"==a?b="<Power_Control><Power>On</Power></Power_Control>":"off"==a||"standby"==a?b="<Power_Control><Power>Standby</Power></Power_Control>":"toggle"==a?b="<Power_Control><Power>On/Standby</Power></Power_Control>":"mute"==a?b="<Volume><Mute>On</Mute></Volume>":"unmute"==a?b="<Volume><Mute>Off</Mute></Volume>":"toggleMute"==a?b="<Volume><Mute>On/Off</Mute></Volume>":
"volumeDown"==a?b="<Volume><Lvl><Val>Down</Val><Exp></Exp><Unit></Unit></Lvl></Volume>":"volumeUp"==a?b="<Volume><Lvl><Val>Up</Val><Exp></Exp><Unit></Unit></Lvl></Volume>":"enhancerOn"==a?b="<Surround><Program_Sel><Current><Enhancer>On</Enhancer></Current></Program_Sel></Surround>":"enhancerOff"==a?b="<Surround><Program_Sel><Current><Enhancer>Off</Enhancer></Current></Program_Sel></Surround>":"directOn"==a?b="<Sound_Video><Pure_Direct><Mode>On</Mode></Pure_Direct></Sound_Video>":"directOff"==a?b=
"<Sound_Video><Pure_Direct><Mode>Off</Mode></Pure_Direct></Sound_Video>":"extraBassOn"==a?b="<Sound_Video><Extra_Bass>Auto</Extra_Bass></Sound_Video>":"extraBassOff"==a?b="<Sound_Video><Extra_Bass>Off</Extra_Bass></Sound_Video>":"straightOn"==a?b="<Surround><Program_Sel><Current><Straight>On</Straight></Current></Program_Sel></Surround>":"straightOff"==a?b="<Surround><Program_Sel><Current><Straight>Off</Straight></Current></Program_Sel></Surround>":"Scene1"==a?b="<Scene><Scene_Sel>Scene 1</Scene_Sel></Scene>":
"Scene2"==a?b="<Scene><Scene_Sel>Scene 2</Scene_Sel></Scene>":"Scene3"==a?b="<Scene><Scene_Sel>Scene 3</Scene_Sel></Scene>":"Scene4"==a?b="<Scene><Scene_Sel>Scene 4</Scene_Sel></Scene>":"play"==a?b="<Play_Control><Playback>Play</Playback></Play_Control>":"pause"==a?b="<Play_Control><Playback>Pause</Playback></Play_Control>":"stop"==a?b="<Play_Control><Playback>Stop</Playback></Play_Control>":"previous"==a?b="<Play_Control><Playback>Skip Rev</Playback></Play_Control>":"next"==a?b="<Play_Control><Playback>Skip Fwd</Playback></Play_Control>":
"up"==a?b="<Cursor_Control><Cursor>Up</Cursor></Cursor_Control>":"down"==a?b="<Cursor_Control><Cursor>Down</Cursor></Cursor_Control>":"left"==a?b="<Cursor_Control><Cursor>Left</Cursor></Cursor_Control>":"right"==a?b="<Cursor_Control><Cursor>Right</Cursor></Cursor_Control>":"enter"==a?b="<Cursor_Control><Cursor>Sel</Cursor></Cursor_Control>":"return"==a?b="<Cursor_Control><Cursor>Return</Cursor></Cursor_Control>":0==a.indexOf("sleep")?(a=a.replace(/sleep/g,"").toLowerCase(),b="off"==a?"<Power_Control><Sleep>Off</Sleep></Power_Control>":
"<Power_Control><Sleep>"+a+" min</Sleep></Power_Control>"):0==a.indexOf("dlgLevel")?(a=a.replace(/dlgLevel/g,"").toLowerCase(),b="<Sound_Video><Dialogue_Adjust><Dialogue_Lvl>"+a+"</Dialogue_Lvl></Dialogue_Adjust></Sound_Video>"):0==a.indexOf("setVideoPreset")?(a=a.replace(/setVideoPreset/g,"").toLowerCase(),f="system",b="<Sound_Video><HDMI><Video><Presetl_Sel><Current>"+a+"</Current></Presetl_Sel></Video></HDMI></Sound_Video>"):0==a.indexOf("tuner")?(d=!1,a=a.replace(/tuner/g,""),b="Up"==a?"<Tuner><Play_Control><Preset><Preset_Sel>Up</Preset_Sel></Preset></Play_Control></Tuner>":
"Down"==a?"<Tuner><Play_Control><Preset><Preset_Sel>Down</Preset_Sel></Preset></Play_Control></Tuner>":"AM"==a?"<Tuner><Play_Control><Tuning><Band>AM</Band></Tuning></Play_Control></Tuner>":"FM"==a?"<Tuner><Play_Control><Tuning><Band>FM</Band></Tuning></Play_Control></Tuner>":"<Tuner><Play_Control><Preset><Preset_Sel>"+a+"</Preset_Sel></Preset></Play_Control></Tuner>"):-1!=this.videoModes.indexOf(a)?b="<Input><Input_Sel>"+a+"</Input_Sel></Input>":-1!=this.audioModes.indexOf(a)?b="Straight"==a?"<Surround><Program_Sel><Current><Straight>On</Straight></Current></Program_Sel></Surround>":
"<Surround><Program_Sel><Current><Sound_Program>"+a+"</Sound_Program></Current></Program_Sel></Surround>":0==a.indexOf("setTo")||/^-?\d*\.{0,1}\d+$/.test(a)?(0==a.indexOf("setTo")&&(a=a.replace(/setTo/g,"")),a=a.replace(/%/g,""),a=Math.round(10*parseFloat(a)),-805>a?a=-805:165<a&&(a=165),b="<Volume><Lvl><Val>"+a+"</Val><Exp>1</Exp><Unit>dB</Unit></Lvl></Volume>"):(d=!1,b=a);d&&(b="system"==f?"<System>"+b+"</System>":"zone2"==f?"<Zone_2>"+b+"</Zone_2>":"zone3"==f?"<Zone_3>"+b+"</Zone_3>":"zone2"==
f?"<Zone_4>"+b+"</Zone_4>":"<Main_Zone>"+b+"</Main_Zone>");h=this;this._doRequest("PUT",b,function(a){a&&400==a.code&&-1!=b.indexOf("Volume")?(a=b.replace(/Volume/g,"Vol"),h._doRequest("PUT",a,c)):c&&c(a)})};d.prototype.getStateValues=function(a,c){return c};d.prototype.toJSON=function(){var a={sys:xnm.aio.yamaha.DM.SYS,type:"avr",ip:this.ip,port:this.port,uuid:this.uuid,model:this.model};this.name&&(a.name=this.name);return a};d.prototype.equalsTo=function(a){return a&&a instanceof d?this.ip==a.ip&&
this.port==a.port:!1};d.DEVICE_1_ZONE="RX-V477 RX-V475 RX-V500D RX-V473 HTR-4067 HTR-5066 HTR-4066 HTR-5065 HTR-4065".split(" ");d.DEVICE_2_ZONE="RX-S600D RX-S600 RX-A1040 RX-A840 RX-A740 RX-A1030 RX-A830 RX-A730 RX-A1020 RX-A820 RX-A720 RX-A1010 RX-A810 RX-A710 RX-A1000 RX-V1077 RX-V777 RX-V677 RX-V577 RX-V1075 RX-V775 RX-V675 RX-V575 RX-V1073 RX-V773 RX-V673 RX-V573 RX-V1071 RX-V871 RX-V771 RX-V671 RX-V1067 RX-V867 HTR-6067 HTR-5067 HTR-6066 TSR-6750 HTR-7065 HTR-6065 HTR-6064 HTR-9063 HTR-8063".split(" ");
d.DEVICE_3_ZONE="RX-A2020 RX-A2010 RX-A2000 RX-V2073 RX-V2071 RX-V2067 RX-V2065 RX-V3900 DSP-AX3900 HTR-6295".split(" ");d.DEVICE_4_ZONE="CX-A5000 RX-A3040 RX-A2040 RX-A3030 RX-A2030 RX-A3020 RX-A3010 RX-A3000 RX-V3077 RX-V2077 RX-V3075 RX-V2075 RX-V3073 RX-V3071 RX-V3067 RX-Z7 DSP-Z7".split(" ");d.parseJSON=function(a){return a.ip?new d(a.ip,a.port,a.uuid,a.name,a.model):null};d.getZoneCount=function(a){return a&&a.model?-1!=d.DEVICE_4_ZONE.indexOf(a.model)?4:-1!=d.DEVICE_3_ZONE.indexOf(a.model)?
3:-1!=d.DEVICE_2_ZONE.indexOf(a.model)?2:1:1};return d}();
xnm.aio.yamaha.DM=function(){var d=function(a,b){this.code=a;this.message=b;this.stack=Error().stack};d.prototype=Error();d.prototype.name="YamahaDMError";d.prototype.code=0;d.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6};var a={avr:{command:[{type:"root",name:"global",value:"global",children:[{type:"string",name:"custom command",ref:{value:"customCMD",ext:"%s"}},{type:"enum",name:"open yamaha AV Controller",ref:{value:"openNative",value_t:"open_app_yamaha"}}]},
{type:"root",name:"tuner",value:"tuner",children:[{type:"enum",name:"preset up",ref:{value:"tunerUp"}},{type:"enum",name:"preset down",ref:{value:"tunerDown"}},{type:"enum",name:"AM",ref:{value:"tunerAM"}},{type:"enum",name:"FM",ref:{value:"tunerFM"}},{type:"int",name:"set preset",ref:{value:"tunerPreset",ext:"%d",extMeta:"1-40",scale:"1"}}]},{type:"root",name:"main zone",value:"mainzone",children:[{type:"enum",name:"power on",ref:{value:"on"}},{type:"enum",name:"power off",ref:{value:"off"}},{type:"enum",
name:"toggle power",ref:{value:"toggle"}},{type:"enum",name:"mute",ref:{value:"mute"}},{type:"enum",name:"unmute",ref:{value:"unmute"}},{type:"enum",name:"toggle mute",ref:{value:"toggleMute"}},{type:"enum",name:"enhancer on",ref:{value:"enhancerOn"}},{type:"enum",name:"enhancer off",ref:{value:"enhancerOff"}},{type:"enum",name:"direct on",ref:{value:"directOn"}},{type:"enum",name:"direct off",ref:{value:"directOff"}},{type:"enum",name:"extra bass on",ref:{value:"extraBassOn"}},{type:"enum",name:"extra bass off",
ref:{value:"extraBassOff"}},{type:"enum",name:"straight on",ref:{value:"straightOn"}},{type:"enum",name:"straight off",ref:{value:"straightOff"}},{type:"enum",name:"scene 1",ref:{value:"Scene1"}},{type:"enum",name:"scene 2",ref:{value:"Scene2"}},{type:"enum",name:"scene 3",ref:{value:"Scene3"}},{type:"enum",name:"scene 4",ref:{value:"Scene4"}},{type:"enum",name:"sleep",ref:{value:"sleep",ext:"%e",extMeta:["30min","60min","90min","120min","off"]}},{type:"enum",name:"set input",ref:{value:"setInput",
ext:"%e",extMeta:"HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link;MULTI CH;PHONO;CD;TV;MD/CD-R;BD/HD DVD;DVD;CBL/SAT;DVR;VCR;V-AUX;DOCK;PC/MCX".split(";")}},{type:"enum",name:"set dsp mode",ref:{value:"audioMode",value_t:"setDSPMode",ext:"%e",extMeta:"2ch Stereo;5ch Stereo;Surround Decoder;Standard;Spectacle;Sci-Fi;Adventure;Drama;Mono Movie;Sports;Action Game;Roleplaying Game;Hall in Munich;Hall in Vienna;Chamber;Cellar Club;The Roxy Theatre;The Bottom Line;Music Video".split(";")}},
{type:"enum",name:"volume up",ref:{value:"volumeUp"}},{type:"enum",name:"volume down",ref:{value:"volumeDown"}},{type:"float",name:"volume to",ref:{value:"setTo",value_t:"volumeTo",unit:"db",ext:"%f",extMeta:"-80.5-16.5",scale:"0.5"}},{type:"enum",name:"play",ref:{value:"play"}},{type:"enum",name:"pause",ref:{value:"pause"}},{type:"enum",name:"stop",ref:{value:"stop"}},{type:"enum",name:"previous",ref:{value:"previous"}},{type:"enum",name:"next",ref:{value:"next"}},{type:"enum",name:"up",ref:{value:"up"}},
{type:"enum",name:"down",ref:{value:"down"}},{type:"enum",name:"left",ref:{value:"left"}},{type:"enum",name:"right",ref:{value:"right"}},{type:"enum",name:"enter",ref:{value:"enter"}},{type:"enum",name:"return",ref:{value:"return"}}]}],status:[{type:"root",name:"main zone",value:"mainzone",children:[{type:"float",name:"volume",ref:{value:"volume",unit:"db",extMeta:"-80.5-16.5",scale:"0.5"}},{type:"enum",name:"power",ref:{value:"power",options:["on","off"]}},{type:"enum",name:"mute",ref:{value:"mute",
options:["on","off"]}},{type:"enum",name:"sleep",ref:{value:"sleep",options:["30min","60min","90min","120min","off"]}},{type:"enum",name:"input",ref:{value:"input",options:"HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link;MULTI CH;PHONO;MULTI CH;PHONO;CD;TV;MD/CD-R;BD/HD DVD;DVD;CBL/SAT;DVR;VCR;V-AUX;DOCK;PC/MCX".split(";")}},{type:"enum",name:"dsp mode",ref:{value:"mode",options:"2ch Stereo;5ch Stereo;Surround Decoder;Standard;Spectacle;Sci-Fi;Adventure;Drama;Mono Movie;Sports;Action Game;Roleplaying Game;Hall in Munich;Hall in Vienna;Chamber;Cellar Club;The Roxy Theatre;The Bottom Line;Music Video;Straight".split(";")}},
{type:"enum",name:"enhancer",ref:{value:"enhancer",options:["on","off"]}},{type:"enum",name:"straight",ref:{value:"straight",options:["on","off"]}},{type:"enum",name:"extra bass",ref:{value:"bass",value_t:"extraBass",options:["on","off"]}},{type:"enum",name:"direct",ref:{value:"direct",value_t:"pureDirect",options:["on","off"]}}]}]},avr_zone_template:{command:[{type:"root",name:"@zone N",value:"zoneN",children:[{type:"enum",name:"power on",ref:{value:"on"}},{type:"enum",name:"power off",ref:{value:"off"}},
{type:"enum",name:"toggle power",ref:{value:"toggle"}},{type:"enum",name:"mute",ref:{value:"mute"}},{type:"enum",name:"unmute",ref:{value:"unmute"}},{type:"enum",name:"toggle mute",ref:{value:"toggleMute"}},{type:"enum",name:"sleep",ref:{value:"sleep",ext:"%e",extMeta:["30min","60min","90min","120min","off"]}},{type:"enum",name:"set input",ref:{value:"setInput",ext:"%e",extMeta:"HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link".split(";")}},
{type:"enum",name:"volume up",ref:{value:"volumeUp"}},{type:"enum",name:"volume down",ref:{value:"volumeDown"}},{type:"float",name:"volume to",ref:{value:"setTo",value_t:"volumeTo",unit:"db",ext:"%f",extMeta:"-80.5-16.5",scale:"0.5"}},{type:"enum",name:"play",ref:{value:"play"}},{type:"enum",name:"pause",ref:{value:"pause"}},{type:"enum",name:"stop",ref:{value:"stop"}},{type:"enum",name:"previous",ref:{value:"previous"}},{type:"enum",name:"next",ref:{value:"next"}},{type:"enum",name:"up",ref:{value:"up"}},
{type:"enum",name:"down",ref:{value:"down"}},{type:"enum",name:"left",ref:{value:"left"}},{type:"enum",name:"right",ref:{value:"right"}},{type:"enum",name:"enter",ref:{value:"enter"}},{type:"enum",name:"return",ref:{value:"return"}}]}],status:[{type:"root",name:"zone N",value:"zoneN",children:[{type:"float",name:"volume",ref:{value:"volume",unit:"db",extMeta:"-80.5-16.5",scale:"0.5"}},{type:"enum",name:"power",ref:{value:"power",options:["on","off"]}},{type:"enum",name:"mute",ref:{value:"mute",options:["on",
"off"]}},{type:"enum",name:"sleep",ref:{value:"sleep",options:["30min","60min","90min","120min","off"]}},{type:"enum",name:"input",ref:{value:"input",options:"HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link".split(";")}}]}]},"avr_RX-A3040":{command:[{type:"root",name:"main zone",value:"mainzone",children:[{type:"int",name:"dialogue level",ref:{value:"dlgLevel",ext:"%d",extMeta:"0-3"}},
{type:"enum",name:"set HDMI video preset",ref:{value:"setVideoPreset",ext:"%e",extMeta:"123456".split("")}}]}],status:[{type:"root",name:"main zone",value:"mainzone",children:[{type:"int",name:"dialogue level",ref:{value:"dlgLevel",ext:"%d",extMeta:"0-3"}},{type:"enum",name:"HDMI video preset",ref:{value:"videoPreset",options:"123456".split("")}}]}]}};return{SYS:"yamaha",getIPDeviceType:function(){return[{sys:this.SYS,name:"Yamaha AV Receiver",type:"avr"}]},createDevice:function(a,b,e){b=d.ERROR_CODE;
a?a.ip?e(null,a):e(new d(b.INVALID,"ip is invalid")):e(new d(b.INVALID,"info is invalid"))},updateDevice:function(a,b,e){b=d.ERROR_CODE;a?a.ip?e(null,a):e(new d(b.INVALID,"ip is invalid")):e(new d(b.INVALID,"info is invalid"))},deleteDevice:function(a,b,d){d()},applyUIFilter:function(a,b,d){var c=function(a,b,d){var e=[];a.forEach(function(a){if("root"==a.type){a=JSON.parse(JSON.stringify(a));var f=c(a.children,b,d);f&&0<f.length&&(a.children=f,e.push(a))}else{f=d.elems;if("*"==f)f=!0;else{for(var g=
!1,h=0;h<f.length;h++)if(f[h]==a.type){g=!0;break}f=g}f&&(a=JSON.parse(JSON.stringify(a)),e.push(a))}});return e},e=function(a,b){var e=[],f=xnm.aio.yamaha.DM.getCommandStatusMap(a,d);if(f){var g=[];switch(b.catagory){case "command":f.command&&(g=c(f.command,a,b));break;case "status":f.status&&(g=c(f.status,a,b))}e=e.concat(g)}return e};if(!a.sys)return null;var h=JSON.parse(JSON.stringify(a)),k=null;switch(b.catagory){case "command":k=e(a,b);h.command=k;break;case "status":k=e(a,b);h.status=k;break;
default:return null}return k&&0!=k.length?h:null},getCommandStatusMap:function(c){if(!c||!c.type)return null;var b=a[c.type];if(!b)return null;b=JSON.parse(JSON.stringify(b));var d=xnm.aio.yamaha.AVR.getZoneCount(c);if(1<d)for(var f=2;f<=d;f++){var g=JSON.parse(JSON.stringify(a.avr_zone_template));g.command[0].name="zone "+f;g.command[0].value="zone"+f;g.status[0].name="zone "+f;g.status[0].value="zone"+f;b.command=b.command.concat(g.command);b.status=b.status.concat(g.status)}c.model&&a[c.type+"_"+
c.model]&&((c=a[c.type+"_"+c.model])&&(c=JSON.parse(JSON.stringify(c))),c&&c.command&&c.command.forEach(function(a){if(a&&"root"==a.type){var c;a:{if((c=a.value)&&b&&b.command)for(var d=0;d<b.command.length;d++)if(b.command[d]&&"root"==b.command[d].type&&b.command[d].value==c){c=b.command[d];break a}c=null}c?(c.children||(c.children=[]),c.children=c.children.concat(a.children)):b.command.push(a)}else b.command.push(a)}),c&&c.status&&c.status.forEach(function(a){if(a&&"root"==a.type){var c;a:{if((c=
a.value)&&b&&b.status)for(var d=0;d<b.status.length;d++)if(b.status[d]&&"root"==b.status[d].type&&b.status[d].value==c){c=b.status[d];break a}c=null}c?(c.children||(c.children=[]),c.children=c.children.concat(a.children)):b.status.push(a)}else b.status.push(a)}));return b}}}();
xnm.aio.yamaha.Handler=function(){var d=function(){this.detectedAVRs={}};d.prototype.devicemanager=xnm.aio.yamaha.DM;d.prototype.AVR=xnm.aio.yamaha.AVR;d.prototype.registModule=function(a){a.register(this.devicemanager.SYS,"yamaha")};d.prototype.resolveDevice=function(a){if(!a)return null;switch(a.type){case "avr":return xnm.aio.yamaha.AVR.parseJSON(a);default:return null}};d.prototype.getDeviceCommands=function(a,c){a=(a=this.devicemanager.applyUIFilter(a,{catagory:"command",elems:"*"}))?a.command:
[];c&&c(null,a)};d.prototype.getDeviceStatus=function(a,c){a=(a=this.devicemanager.applyUIFilter(a,{catagory:"status",elems:"*"}))?a.status:[];c&&c(null,a)};d.prototype.doCommand=function(a,c,b){var d=this.resolveDevice(a);d?d.executeCommandCreator(a,c,function(a){b&&b(a)}):b&&b(Error("device json format invalid"))};d.prototype.doStatus=function(a,c,b,d){var f=this.resolveDevice(c);f?f.getStatesCreator(null,[{id:a,device:c,status:b}],function(a,b){a?d&&d(a):d&&d(null,b[0])}):d&&d(Error("device json format invalid"))};
d.prototype.discoverDevices=function(a){var c=function(a){if(!a)return a;var b;for(b=0;b<xnm.aio.yamaha.AVR.DEVICE_1_ZONE.length;b++){var c=xnm.aio.yamaha.AVR.DEVICE_1_ZONE[b];if(-1!=a.indexOf(c))return c}for(b=0;b<xnm.aio.yamaha.AVR.DEVICE_2_ZONE.length;b++)if(c=xnm.aio.yamaha.AVR.DEVICE_2_ZONE[b],-1!=a.indexOf(c))return c;for(b=0;b<xnm.aio.yamaha.AVR.DEVICE_3_ZONE.length;b++)if(c=xnm.aio.yamaha.AVR.DEVICE_3_ZONE[b],-1!=a.indexOf(c))return c;for(b=0;b<xnm.aio.yamaha.AVR.DEVICE_4_ZONE.length;b++)if(c=
xnm.aio.yamaha.AVR.DEVICE_4_ZONE[b],-1!=a.indexOf(c))return c;return a},b=require("x.upnp.js");if(b){var d=this;b.discoverDevicesWithTimeout(3E3,function(b){if(b.manufacturer&&0==b.manufacturer.indexOf("Yamaha")&&"AV Receiver"==b.modelDescription){var e=c(b.modelName);e=new xnm.aio.yamaha.AVR(b.ip,80,b.uuid,b.name,e);d.detectedAVRs["uuid:"+b.uuid]||(d.detectedAVRs["uuid:"+b.uuid]=e);a(e)}})}};d.prototype.discoverWithTimeout=function(a,c){var b={};this.discoverDevices(function(a){a&&a.uuid&&!b[a.uuid]&&
(b[a.uuid]=a)});setTimeout(function(){var a=[],d;for(d in b)b.hasOwnProperty(d)&&a.push(b[d]);c&&c(null,a)},a)};d.prototype.getStateValues=function(a,c){return(new xnm.aio.yamaha.AVR).getStateValues(a.type,c)};d.prototype.getDeviceCommandList=function(a,c,b){return[]};return d}();"undefined"!=typeof module&&null!=module&&(module.exports=new xnm.aio.yamaha.Handler);
