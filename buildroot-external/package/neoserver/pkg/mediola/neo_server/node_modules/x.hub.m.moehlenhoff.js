var x=x||{};x.hub=x.hub||{};x.hub.m=x.hub.m||{};x.hub.m.moehlenhoff=x.hub.m.moehlenhoff||{};x.hub.m.moehlenhoff.APLHA_MODULE=require("xnm.aio.moehlenhoff.js");
x.hub.m.moehlenhoff.Handler=function(){var h=function(){};h.prototype.init=function(b){b&&b()};h.prototype.getSystems=function(){return["moehlenhoff"]};h.prototype.executeCommandV6=function(b,f,a,g){if(b=b?b.address:null)if(f=x.hub.m.moehlenhoff.APLHA_MODULE.resolveGateway({sys:"alpha2",ip:f?f.address:null})){b=b.split(":");b={sys:"alpha2",address:b[0],dpt:"HEATAREA",number:b[1]};var e={value:null,ext:null};switch(a.command){case "temperature":e.value="target_temp";e.ext=a.value;break;case "mode":e.value=
a.value;break;case "weekday":e.value="w_p"+a.value;break;case "weekend":e.value="we_p"+a.value;break;case "disableVacation":e.value="vac_off";b.dpt="DEVICE";break;case "vacation":if(!a.value||!a.value.start||!a.value.end){a=Error("invalid parameter");a.code="000000";g&&g(a);return}e.value="vac_on";e.ext=[{value:"start",ext:a.value.start},{value:"end",ext:a.value.end}];b.dpt="DEVICE"}f.executeCommandCreator(b,e,function(a){a&&(a.code="000000");g&&g(a)})}else a=Error("invalid gateway json"),a.code=
"000000",g&&g(a);else a=Error("invalid device json"),a.code="000000",g&&g(a)};h.prototype.getStatesV6=function(b,f,a){var g=b?b.address:null;g?(b=x.hub.m.moehlenhoff.APLHA_MODULE.resolveGateway({sys:"alpha2",ip:f?f.address:null}))?b._getStates(function(b,f){if(b)a&&a(b);else{b=g.split(":");var c={};if(f)for(var e=0;e<f.length;e++){var k=f[e];if(k&&k.id==b[0]&&(c.vacation="on"==k.vacation?1:0,k.heatAreas))for(var h=0;h<k.heatAreas.length;h++){var d=k.heatAreas[h];d&&d.number==b[1]&&(c.state=d.target_temp/
5,c.temperature=d.actual_temp,c.mode=d.mode,c.battery=d.battery,c.signal=d.signal,c.party=d.party,"active"==d.prog_week_0?c.weekday=0:"active"==d.prog_week_1?c.weekday=1:"active"==d.prog_week_2?c.weekday=2:"active"==d.prog_week_3&&(c.weekday=3),"active"==d.prog_weekend_0?c.weekend=0:"active"==d.prog_weekend_1?c.weekend=1:"active"==d.prog_weekend_2?c.weekend=2:"active"==d.prog_weekend_3&&(c.weekend=3))}}a&&a(null,c)}}):(b=Error("invalid gateway json"),b.code="000000",a&&a(b)):(b=Error("invalid device json"),
b.code="000000",a&&a(b))};return h}();"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new x.hub.m.moehlenhoff.Handler);
