var xnm=xnm||{};xnm.aio=xnm.aio||{};xnm.aio.orvibo=xnm.aio.orvibo||{};xnm.aio.orvibo.Device=function(){this.ip=null;this.port=1E4;this.CommandHandler=this.uuid=null};
xnm.aio.orvibo.Device.prototype._sendMessage=function(a,b,c){var d=[104,100,0];d.push(b.length+12);d.push((a&65280)>>8);d.push(a&255);a=this.uuid.replace(/-/g,"");for(var e=0;6>e;e++)d.push(parseInt(a.substr(2*e,2),16));for(e=0;e<b.length;e++)d.push(b[e]);b=new Buffer(d);var f=require("dgram").createSocket("udp4");f.send(b,0,b.length,1E4,this.ip,function(a,b){f.close();c&&setTimeout(function(){c.call()},100)})};
xnm.aio.orvibo.Device.prototype._subscribe=function(a){if(this.uuid&&17==this.uuid.length){for(var b=[32,32,32,32,32,32],c=this.uuid.replace(/-/g,""),d=5;0<=d;d--)b.push(parseInt(c.substr(2*d,2),16));b=b.concat([32,32,32,32,32,32]);this._sendMessage(25452,b,a)}};xnm.aio.orvibo.Socket=function(a,b,c){this.ip=a;this.uuid=b;this.port=c;this.port||(this.port=1E4);this._state="?";this._getStateCallbacksTimeout=null;this._getStateCallbacks=[]};xnm.aio.orvibo.Socket.prototype=new xnm.aio.orvibo.Device;
xnm.aio.orvibo.Socket.prototype.constructor=xnm.aio.orvibo.Socket;xnm.aio.orvibo.Socket.prototype.getState=function(a){var b=this;this._subscribe(function(){setTimeout(function(){a(b._state)},100)})};
xnm.aio.orvibo.Socket.prototype.executeCommand=function(a,b,c){var d=this;this._subscribe(function(){var a=[32,32,32,32,32,32,0,0,0,0];if("on"==b)a.push(1);else if("off"==b)a.push(0);else if("toggle"==b){setTimeout(function(){"off"==d._state?a.push(1):a.push(0);d._sendMessage(25699,a,function(){d._sendMessage(25699,a,c)})},100);return}d._sendMessage(25699,a,function(){d._sendMessage(25699,a,c)})})};
xnm.aio.orvibo.Socket.prototype.getStates=function(a,b,c){var d=this;this.CommandHandler=a;this.getState(function(a){var e={state:a};b&&d.CommandHandler&&d.CommandHandler.setState?d.CommandHandler.setState(b.id,a):d.CommandHandler&&d.CommandHandler.receivedState&&d.CommandHandler.receivedState("orvibo",d.uuid,e);c&&c(e)})};xnm.aio.orvibo.Socket.prototype.getStateValues=function(a){return a};xnm.aio.orvibo.AllOne=function(a,b){this.ip=a;this.uuid=b;this._learnedIRCallback=null};
xnm.aio.orvibo.AllOne.prototype=new xnm.aio.orvibo.Device;xnm.aio.orvibo.AllOne.prototype.constructor=xnm.aio.orvibo.AllOne;xnm.aio.orvibo.AllOne.prototype.learnIR=function(a){var b=this;this._learnedIRCallback=a;this._subscribe(function(){var a=[32,32,32,32,32,32,0,0,0,0,0];b._sendMessage(27763,a,function(){b._sendMessage(27763,a);setTimeout(function(){b._learnedIRCallback&&(b._learnedIRCallback(),b._learnedIRCallback=null)},1E4)})})};
xnm.aio.orvibo.AllOne.prototype.sendIR=function(a,b){var c=this;this._subscribe(function(){var d=new Buffer(a,"hex"),e=[32,32,32,32,32,32,0,0,0,0];e.push(Math.floor(255*Math.random()));e.push(Math.floor(255*Math.random()));e.push(Math.floor(255*Math.random()));for(var f=0;f<d.length;f++)e.push(d[f]);c._sendMessage(26979,e,function(){c._sendMessage(26979,e,b)})})};xnm.aio.orvibo.AllOne.prototype.getStates=function(a,b,c){c&&c({})};xnm.aio.orvibo.AllOne.prototype.getStateValues=function(a){return a};
xnm.aio.orvibo.Discovery=function(){this.Devices={};this.callback=null;this._sockets=[];var a=require("os");require("dgram");if(a&&a.networkInterfaces){a=a.networkInterfaces();for(var b in a)for(var c=a[b],d=0;d<c.length;d++)this._addDiscoverSocket(1E4,c[d])}else this._addDiscoverSocket(1E4,null)};xnm.aio.orvibo.Discovery.prototype._getMAC=function(a){for(var b="",c=0;5>c;c++)b+=XC.getHexVal(a[c],2).toUpperCase()+"-";return b+=XC.getHexVal(a[c],2).toUpperCase()};
xnm.aio.orvibo.Discovery.prototype._receivedData=function(a,b){b=b.toString("hex");b=new Buffer(b,"hex");XC.debugf("orvibo received data from "+a+" ("+b.length+")");41==b.length||42==b.length?(113==b[4]&&97==b[5]&&(41==b.length?this.Devices[a]||(this.Devices[a]=new xnm.aio.orvibo.AllOne(a)):(this.Devices[a]||(this.Devices[a]=new xnm.aio.orvibo.Socket(a)),this.Devices[a]._state=1==b[41]?"on":"off"),this.Devices[a].uuid=this._getMAC(b.slice(7,13))),this.callback&&this.Devices[a]&&this.callback(this.Devices[a])):
23==b.length||24==b.length?this.Devices[a]&&(99==b[4]&&108==b[5]||115==b[4]&&102==b[5])&&(1==b[b.length-1]?(this.Devices[a]._state="on",this.Devices[a]instanceof xnm.aio.orvibo.Socket&&this.Devices[a].setState("on")):(this.Devices[a]._state="off",this.Devices[a]instanceof xnm.aio.orvibo.Socket&&this.Devices[a].setState("off")),this.Devices[a].CommandHandler&&this.Devices[a].CommandHandler.receivedState&&this.Devices[a].CommandHandler.receivedState("orvibo",this.Devices[a].uuid,{state:this.Devices[a]._state})):
28<b.length&&108==b[4]&&115==b[5]&&(b=b.toString("hex"),b=b.substr(48,2)+b.substr(52),this.Devices[a]&&this.Devices[a]._learnedIRCallback&&(this.Devices[a]._learnedIRCallback(b),this.Devices[a]._learnedIRCallback=null))};
xnm.aio.orvibo.Discovery.prototype._addDiscoverSocket=function(a,b){var c=require("dgram"),d=this;if(!b){try{var e=c.createSocket({reuseAddr:!0,type:"udp4"})}catch(f){e=c.createSocket("udp4")}e.on("message",function(a,b){d._receivedData(b.address,a)});e.on("error",function(a){});e.bind(a);this._sockets.push(e)}else if("IPv4"==b.family&&0==b.internal){try{e=c.createSocket({reuseAddr:!0,type:"udp4"})}catch(f){e=c.createSocket("udp4")}e.on("listening",function(){e.setBroadcast(!0)});e.on("message",function(a,
b){d._receivedData(b.address,a)});e.on("error",function(a){});e.bind(a,b.address);this._sockets.push(e)}};xnm.aio.orvibo.Discovery.prototype._sendDiscoveryMessages=function(a,b,c,d){a=new Buffer([104,100,0,6,113,97]);for(b=0;b<this._sockets.length;b++)this._sockets[b].send(a,0,a.length,1E4,"255.255.255.255")};xnm.aio.orvibo.Discovery.prototype.discoverDevices=function(){this._sendDiscoveryMessages()};xnm.aio.orvibo.Handler=function(){this._Discovery=new xnm.aio.orvibo.Discovery;this._Discovery.discoverDevices()};
xnm.aio.orvibo.Handler.prototype.discoverDevices=function(a){a&&(this._Discovery.callback=a);this._Discovery.discoverDevices()};xnm.aio.orvibo.Handler.prototype.getStateValues=function(a,b){return(new xnm.aio.orvibo.Socket).getStateValues(b)};xnm.aio.orvibo.Handler.prototype.getDeviceCommandList=function(a,b){a=[];a.push({id:window.XC_Text.on,cmd:"on"});a.push({id:window.XC_Text.off,cmd:"off"});return a};
xnm.aio.orvibo.Handler.prototype.getDevice=function(a){for(var b in this._Discovery.Devices)if(a.address&&this._Discovery.Devices[b].uuid==a.address)return this._Discovery.Devices[b];return null};xnm.aio.orvibo.Handler.prototype.Socket=xnm.aio.orvibo.Socket;xnm.aio.orvibo.Handler.prototype.AllOne=xnm.aio.orvibo.AllOne;
xnm.aio.orvibo.DMError=function(){var a=function(a,c){this.code=a;this.message=c;this.stack=Error().stack};a.prototype=Error();a.prototype.name="OrviboDmError";a.prototype.code=0;a.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6};return a}();
xnm.aio.orvibo.DM=function(){return{getGatewayType:function(a){var b=[],c;for(c in xnm.aio.orvibo)if(xnm.aio.orvibo.hasOwnProperty(c)){var d=xnm.aio.orvibo[c];d&&d.DM&&d.DM.getGatewayType&&(d=d.DM.getGatewayType(a))&&(d.constructor===Array?b=b.concat(d):b.push(d))}return b},getIPDeviceType:function(a,b){var c=[],d;for(d in xnm.aio.orvibo)if(xnm.aio.orvibo.hasOwnProperty(d)){var e=xnm.aio.orvibo[d];e&&e.DM&&e.DM.getIPDeviceType&&(e=e.DM.getIPDeviceType(a,b))&&c.push(e)}return c},_getSystem:function(a){for(var b in xnm.aio.orvibo)if(xnm.aio.orvibo.hasOwnProperty(b)){var c=
xnm.aio.orvibo[b];if(c&&c.DM&&c.DM.SYS&&c.DM.SYS==a)return c}return null},createGateway:function(a,b,c){var d=xnm.aio.orvibo.DMError,e=xnm.aio.orvibo.DMError.ERROR_CODE;if(a)if(a.sys){var f=this._getSystem(a.sys);f&&f.DM&&f.DM.createGateway?f.DM.createGateway(a,b,c):c&&c(new d(e.INVALID,"no such sys:"+a.sys))}else c&&c(new d(e.INVALID,"sys is invalid"));else c&&c(new d(e.INVALID,"info is invalid"))},updateGateway:function(a,b,c,d){var e=xnm.aio.orvibo.DMError,f=xnm.aio.orvibo.DMError.ERROR_CODE;if(b)if(b.sys){var g=
this._getSystem(b.sys);g&&g.DM&&g.DM.updateGateway?g.DM.updateGateway(a,b,c,d):d&&d(new e(f.INVALID,"no such sys:"+b.sys))}else d&&d(new e(f.INVALID,"sys is invalid"));else d&&d(new e(f.INVALID,"update is invalid"))},deleteGateway:function(a,b,c){var d=xnm.aio.orvibo.DMError,e=xnm.aio.orvibo.DMError.ERROR_CODE;if(a)if(a.sys){var f=this._getSystem(a.sys);f&&f.DM&&f.DM.deleteGateway?f.DM.deleteGateway(a,b,c):c&&c(new d(e.INVALID,"no such sys:"+a.sys))}else c&&c(new d(e.INVALID,"sys is invalid"));else c&&
c()},createDevice:function(a,b,c){var d=xnm.aio.orvibo.DMError,e=xnm.aio.orvibo.DMError.ERROR_CODE;if(a)if(a.sys){var f=this._getSystem(a.sys);f&&f.DM&&f.DM.createDevice?f.DM.createDevice(a,b,c):c&&c(new d(e.INVALID,"no such sys:"+a.sys))}else c&&c(new d(e.INVALID,"sys is invalid"));else c&&c(new d(e.INVALID,"info is invalid"))},updateDevice:function(a,b,c){var d=xnm.aio.orvibo.DMError,e=xnm.aio.orvibo.DMError.ERROR_CODE;if(a)if(a.sys){var f=this._getSystem(a.sys);f&&f.DM&&f.DM.updateDevice?f.DM.updateDevice(a,
b,c):c&&c(new d(e.INVALID,"no such sys:"+a.sys))}else c&&c(new d(e.INVALID,"sys is invalid"));else c&&c(new d(e.INVALID,"info is invalid"))},deleteDevice:function(a,b,c){var d=xnm.aio.orvibo.DMError,e=xnm.aio.orvibo.DMError.ERROR_CODE;if(a)if(a.sys){var f=this._getSystem(a.sys);f&&f.DM&&f.DM.deleteDevice?f.DM.deleteDevice(a,b,c):c&&c(new d(e.INVALID,"no such sys:"+a.sys))}else c&&c(new d(e.INVALID,"sys is invalid"));else c&&c()},applyUIFilter:function(a,b){var c=function(a,b){if("*"==a)return!0;for(var c=
!1,d=0;d<a.length;d++)if(a[d]==b){c=!0;break}return c},d=function(a,b,d){var e=[];switch(d.catagory){case "command":a.command&&a.command.forEach(function(a){c(d.elems,a.type)&&(a=JSON.parse(JSON.stringify(a)),e.push(a))});break;case "status":a.status&&a.status.forEach(function(a){c(d.elems,a.type)&&(a=JSON.parse(JSON.stringify(a)),e.push(a))})}return e},e=function(a,b){var c=[],e;if(a.sys){var f=this._getSystem(a.sys);f&&f.DM&&f.DM.getCommandStatusMap&&(e=f.DM.getCommandStatusMap(a))}e&&(a=d(e,a,
b),c=c.concat(a));return c};if(!a.sys)return null;var f=JSON.parse(JSON.stringify(a)),g=null;switch(b.catagory){case "command":g=e.call(this,a,b);f.command=g;break;case "status":g=e.call(this,a,b);f.status=g;break;default:return null}return g&&0!=g.length?f:null}}}();xnm.aio.orvibo.Socket.prototype.executeCommandCreator=function(a,b,c){b&&b.value?this.executeCommand(null,b.value,function(){c&&c()}):c&&c(Error("command invalid"))};
xnm.aio.orvibo.Socket.prototype.getStatesCreator=function(a,b,c){this._getState(function(a){for(var d=[],f=0;f<b.length;f++)if(b[f]&&b[f].id){var g="?";b[f].status&&b[f].status.value&&a&&a[b[f].status.value]&&(g=a[b[f].status.value]);d.push({id:b[f].id,status:g})}c&&c(null,d)})};
xnm.aio.orvibo.Socket.prototype.setState=function(a){console.log("set state");this._getStateCallbacksTimeout&&(clearTimeout(this._getStateCallbacksTimeout),this._getStateCallbacksTimeout=null);this._state=a;a=this._getStateCallbacks;this._getStateCallbacks=[];if(a)for(var b=0;b<a.length;b++)if(a[b])a[b]({state:this._state})};
xnm.aio.orvibo.Socket.prototype._getState=function(a){if(a)if(this._getStateCallbacks||(this._getStateCallbacks=[]),0!=this._getStateCallbacks.length)-1==this._getStateCallbacks.indexOf(a)&&this._getStateCallbacks.push(a);else{this._getStateCallbacks.push(a);var b=this;this._getStateCallbacksTimeout=setTimeout(function(){console.log("state timeout");b.setState("?")},1E3);this._subscribe()}};
xnm.aio.orvibo.Socket.prototype.toJSON=function(){return{sys:xnm.aio.orvibo.Socket.DM.SYS,ip:this.ip,port:this.port,mac:this.uuid}};xnm.aio.orvibo.Socket.prototype.equalsTo=function(a){return a&&a instanceof xnm.aio.orvibo.Socket?this.ip==a.ip&&this.port==a.port&&this.uuid==a.uuid:!1};
xnm.aio.orvibo.Socket.parseJSON=function(a){if(!a.ip)return null;var b=a.mac;if(!a.mac){var c=require("xnm.aio.orvibo.js");c&&c._Discovery&&c._Discovery.Devices&&(b=c._Discovery.Devices[a.ip])}return b?new xnm.aio.orvibo.Socket(a.ip,b,a.port):null};
xnm.aio.orvibo.Socket.DM=function(){return{SYS:"orvibo_socket",MAP:{command:[{type:"enum",name:"on",ref:{value:"on"}},{type:"enum",name:"off",ref:{value:"off"}},{type:"enum",name:"toggle",ref:{value:"toggle"}}],status:[{type:"enum",name:"state",ref:{value:"state",options:["on","off"]}}]},registModule:function(a){a.register(this.SYS,"orvibo")},getIPDeviceType:function(){return{sys:this.SYS,name:"ORVIBO WiWo Smart Socket",port:1E4}},createDevice:function(a,b,c){b=xnm.aio.orvibo.DMError;var d=xnm.aio.orvibo.DMError.ERROR_CODE;
a?a.ip?a.mac?c(null,a):c(new b(d.INVALID,"mac is invalid")):c(new b(d.INVALID,"ip is invalid")):c(new b(d.INVALID,"info is invalid"))},updateDevice:function(a,b,c){b=xnm.aio.orvibo.DMError;var d=xnm.aio.orvibo.DMError.ERROR_CODE;a?a.ip?a.mac?c(null,a):c(new b(d.INVALID,"mac is invalid")):c(new b(d.INVALID,"ip is invalid")):c(new b(d.INVALID,"info is invalid"))},deleteDevice:function(a,b,c){c()},getCommandStatusMap:function(a){return this.MAP}}}();
xnm.aio.orvibo.AllOne.prototype.executeCommandCreator=function(a,b,c){if(b&&b.value)if(a&&a.ircodes&&a.ircodes.codes){for(var d,e=0;e<a.ircodes.codes.length;e++){var f=a.ircodes.codes[e];if(f.key==b.value){d=f.code;break}}d?this.sendIR(d,function(){c&&c()}):c&&c(Error("no such ir code:"+b.value))}else c&&c(Error("device has no ir codes"));else c&&c(Error("command invalid"))};xnm.aio.orvibo.AllOne.prototype.toJSON=function(){return{sys:xnm.aio.orvibo.AllOne.DM.SYS,ip:this.ip,port:this.port,mac:this.uuid}};
xnm.aio.orvibo.AllOne.prototype.equalsTo=function(a){return a&&a instanceof xnm.aio.orvibo.AllOne?this.ip==a.ip&&this.port==a.port&&this.uuid==a.uuid:!1};xnm.aio.orvibo.AllOne.parseJSON=function(a){if(!a.ip)return null;var b=a.mac;if(!a.mac){var c=require("xnm.aio.orvibo.js");c&&c._Discovery&&c._Discovery.Devices&&(b=c._Discovery.Devices[a.ip])}if(!b)return null;b=new xnm.aio.orvibo.AllOne(a.ip,b);a.port&&0<parseInt(a.port)&&(b.port=parseInt(a.port));return b};
xnm.aio.orvibo.AllOne.DM=function(){return{SYS:"orvibo_ir",registModule:function(a){a.register(this.SYS,"orvibo")},getGatewayType:function(){return[{sys:this.SYS,name:"NUEVA-IR-BLAST",port:1E4,vendor:"nueva"},{sys:this.SYS,name:"ORVIBO AllOne",port:1E4,vendor:"orvibo"}]},createGateway:function(a,b,c){b=xnm.aio.orvibo.DMError;var d=xnm.aio.orvibo.DMError.ERROR_CODE;a?a.ip?a.mac?c(null,a):c(new b(d.INVALID,"mac is invalid")):c(new b(d.INVALID,"ip is invalid")):c(new b(d.INVALID,"info is invalid"))},
updateGateway:function(a,b,c,d){a=xnm.aio.orvibo.DMError;c=xnm.aio.orvibo.DMError.ERROR_CODE;b?b.ip?d(null,b):d(new a(c.INVALID,"ip is invalid")):d(new a(c.INVALID,"update is invalid"))},deleteGateway:function(a,b,c){c()},createDevice:function(a,b,c){var d=xnm.aio.orvibo.DMError,e=xnm.aio.orvibo.DMError.ERROR_CODE;if(a.gateway)if(b.data&&b.data.gateways&&0!==b.data.gateways.length){b=b.data.gateways;var f;for(f=0;f<b.length;f++)if(b[f].index===a.gateway){var g=b[f];break}g?c(null,a):c(new d(e.NOT_FOUND,
"gateway with index "+a.gateway+" not exists"))}else c(new d(e.NOT_FOUND,"gateway with index "+a.gateway+" not exists"));else c(new d(e.INVALID,"gateway is invalid"))},updateDevice:function(a,b,c){var d=xnm.aio.orvibo.DMError,e=xnm.aio.orvibo.DMError.ERROR_CODE;if(a)if(a.gateway){b=b.data.gateways;var f;for(f=0;f<b.length;f++)if(b[f].index===a.gateway){var g=b[f];break}g?c(null,a):c(new d(e.NOT_FOUND,"gateway with index "+a.gateway+" not exists"))}else c(new d(e.INVALID,"gateway is invalid"));else c(new d(e.INVALID,
"info is invalid"))},deleteDevice:function(a,b,c){c()},getCommandStatusMap:function(a){var b={command:[]};if(a&&a.ircodes&&a.ircodes.codes){for(var c=0;c<a.ircodes.codes.length;c++){var d=a.ircodes.codes[c];b.command.push({type:"enum",name:d.key,ref:{value:d.key}})}return b}return null}}}();xnm.aio.orvibo.Handler.prototype.devicemanager=xnm.aio.orvibo.DM;
xnm.aio.orvibo.Handler.prototype.registModule=function(a){for(var b in xnm.aio.orvibo)if(xnm.aio.orvibo.hasOwnProperty(b)){var c=xnm.aio.orvibo[b];c&&c.DM&&c.DM.registModule&&c.DM.registModule(a)}};
xnm.aio.orvibo.Handler.prototype.resolveGateway=function(a){if(!a)return null;switch(a.sys){case xnm.aio.orvibo.AllOne.DM.SYS:if(!a.ip)return null;this._Discovery.Devices||(this._Discovery.Devices={});var b=this._Discovery.Devices[a.ip];if(b)return b;b=xnm.aio.orvibo.AllOne.parseJSON(a);return b?this._Discovery.Devices[a.ip]=b:null;default:return null}};
xnm.aio.orvibo.Handler.prototype.resolveDevice=function(a){switch(a.sys){case xnm.aio.orvibo.Socket.DM.SYS:if(!a.ip)return null;this._Discovery.Devices||(this._Discovery.Devices={});var b=this._Discovery.Devices[a.ip];if(b)return b;b=xnm.aio.orvibo.Socket.parseJSON(a);return b?this._Discovery.Devices[a.ip]=b:null;default:return null}};xnm.aio.orvibo.Handler.prototype.getDeviceCommands=function(a,b){a=(a=xnm.aio.orvibo.DM.applyUIFilter(a,{catagory:"command",elems:"*"}))?a.command:[];b&&b(null,a)};
xnm.aio.orvibo.Handler.prototype.getDeviceStatus=function(a,b){a=(a=this.devicemanager.applyUIFilter(a,{catagory:"status",elems:"*"}))?a.status:[];b&&b(null,a)};xnm.aio.orvibo.Handler.prototype.searchDeviceWithTimeout=function(a,b){var c=[];this._Discovery.callback=function(a){for(var b=0;b<c.length;b++)if(c[b]&&c[b].ip==a.ip)return;c.push(a)};this._Discovery.discoverDevices();setTimeout(function(){b&&b(null,c)},a)};
xnm.aio.orvibo.Handler.prototype.searchIRBlastWithTimeout=function(a,b){this.searchDeviceWithTimeout(a,function(a,d){if(a)b&&b(a);else{a=[];for(var c=0;c<d.length;c++)d[c]&&d[c]instanceof xnm.aio.orvibo.AllOne&&a.push(d[c]);b&&b(null,a)}})};xnm.aio.orvibo.Handler.prototype.learnIRCode=function(a,b,c){(a=this.resolveGateway(a))&&a instanceof xnm.aio.orvibo.AllOne?a.learnIR(function(a){var b=a?null:Error("learn ir code error");c&&c(b,a)}):c&&c(Error("gateway json format invalid"))};
xnm.aio.orvibo.Handler.prototype.doIRCommand=function(a,b,c,d){(a=this.resolveGateway(a))&&a instanceof xnm.aio.orvibo.AllOne?a.executeCommandCreator(b,c,d):d&&d(Error("gateway json format invalid"))};xnm.aio.orvibo.Handler.prototype.searchSocketWithTimeout=function(a,b){this.searchDeviceWithTimeout(a,function(a,d){if(a)b&&b(a);else{a=[];for(var c=0;c<d.length;c++)d[c]&&d[c]instanceof xnm.aio.orvibo.Socket&&a.push(d[c]);b&&b(null,a)}})};
xnm.aio.orvibo.Handler.prototype.doSocketCommand=function(a,b,c){var d=this.resolveDevice(a);d?d.executeCommandCreator(a,b,function(a){c&&c(a)}):c&&c(Error("device json format invalid"))};xnm.aio.orvibo.Handler.prototype.doSocketStatus=function(a,b,c,d){var e=this.resolveDevice(b);e?e.getStatesCreator(null,[{id:a,device:b,status:c}],function(a,b){a?d&&d(a):d&&d(null,b[0])}):d&&d(Error("device json format invalid"))};
"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new xnm.aio.orvibo.Handler);
